{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/vijaygopalb/AgentOS/apps/dashboard/src/components/layout/PageHeader.tsx"],"sourcesContent":["\"use client\";\n\ninterface PageHeaderProps {\n  title: string;\n  subtitle?: string;\n}\n\nexport function PageHeader({ title, subtitle }: PageHeaderProps) {\n  return (\n    <div className=\"mb-6\">\n      <h1 className=\"text-2xl font-heading font-bold text-white\">{title}</h1>\n      {subtitle && (\n        <p className=\"mt-1 text-sm text-white/50\">{subtitle}</p>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;;AAOO,SAAS,WAAW,EAAE,KAAK,EAAE,QAAQ,EAAmB;IAC7D,qBACE,6WAAC;QAAI,WAAU;;0BACb,6WAAC;gBAAG,WAAU;0BAA8C;;;;;;YAC3D,0BACC,6WAAC;gBAAE,WAAU;0BAA8B;;;;;;;;;;;;AAInD"}},
    {"offset": {"line": 42, "column": 0}, "map": {"version":3,"sources":["file:///Users/vijaygopalb/AgentOS/apps/dashboard/src/components/shared/Panel.tsx"],"sourcesContent":["\"use client\";\n\nimport type { ReactNode } from \"react\";\n\ninterface PanelProps {\n  children: ReactNode;\n  className?: string;\n}\n\nexport function Panel({ children, className = \"\" }: PanelProps) {\n  return (\n    <div\n      className={`glass-panel p-6 ${className}`}\n    >\n      {children}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;;AASO,SAAS,MAAM,EAAE,QAAQ,EAAE,YAAY,EAAE,EAAc;IAC5D,qBACE,6WAAC;QACC,WAAW,CAAC,gBAAgB,EAAE,WAAW;kBAExC;;;;;;AAGP"}},
    {"offset": {"line": 63, "column": 0}, "map": {"version":3,"sources":["file:///Users/vijaygopalb/AgentOS/apps/dashboard/src/components/shared/Tag.tsx"],"sourcesContent":["\"use client\";\n\ntype TagVariant = \"default\" | \"success\" | \"warning\" | \"danger\" | \"info\";\n\ninterface TagProps {\n  children: React.ReactNode;\n  variant?: TagVariant;\n  className?: string;\n}\n\nconst variantStyles: Record<TagVariant, string> = {\n  default:\n    \"bg-white/10 text-white/70\",\n  success:\n    \"bg-success/15 text-success\",\n  warning:\n    \"bg-warning/15 text-warning\",\n  danger:\n    \"bg-danger/15 text-danger\",\n  info:\n    \"bg-accent-blue/15 text-accent-blue\",\n};\n\nexport function Tag({ children, variant = \"default\", className = \"\" }: TagProps) {\n  return (\n    <span\n      className={`inline-flex items-center px-2.5 py-0.5 text-xs font-medium rounded-pill ${variantStyles[variant]} ${className}`}\n    >\n      {children}\n    </span>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;;AAUA,MAAM,gBAA4C;IAChD,SACE;IACF,SACE;IACF,SACE;IACF,QACE;IACF,MACE;AACJ;AAEO,SAAS,IAAI,EAAE,QAAQ,EAAE,UAAU,SAAS,EAAE,YAAY,EAAE,EAAY;IAC7E,qBACE,6WAAC;QACC,WAAW,CAAC,wEAAwE,EAAE,aAAa,CAAC,QAAQ,CAAC,CAAC,EAAE,WAAW;kBAE1H;;;;;;AAGP"}},
    {"offset": {"line": 91, "column": 0}, "map": {"version":3,"sources":["file:///Users/vijaygopalb/AgentOS/apps/dashboard/src/components/shared/Input.tsx"],"sourcesContent":["\"use client\";\n\nimport type { InputHTMLAttributes } from \"react\";\n\ninterface InputProps extends InputHTMLAttributes<HTMLInputElement> {\n  label?: string;\n}\n\nexport function Input({ label, className = \"\", id, ...props }: InputProps) {\n  const inputId = id || label?.toLowerCase().replace(/\\s+/g, \"-\");\n  return (\n    <div className=\"flex flex-col gap-1.5\">\n      {label && (\n        <label htmlFor={inputId} className=\"text-xs text-white/50 font-medium\">\n          {label}\n        </label>\n      )}\n      <input\n        id={inputId}\n        className={`bg-white/5 border border-surface-border rounded-input px-3 py-2 text-sm text-white placeholder:text-white/30 focus:outline-none focus:border-accent-blue/50 focus:ring-1 focus:ring-accent-blue/20 transition-colors ${className}`}\n        {...props}\n      />\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;;AAQO,SAAS,MAAM,EAAE,KAAK,EAAE,YAAY,EAAE,EAAE,EAAE,EAAE,GAAG,OAAmB;IACvE,MAAM,UAAU,MAAM,OAAO,cAAc,QAAQ,QAAQ;IAC3D,qBACE,6WAAC;QAAI,WAAU;;YACZ,uBACC,6WAAC;gBAAM,SAAS;gBAAS,WAAU;0BAChC;;;;;;0BAGL,6WAAC;gBACC,IAAI;gBACJ,WAAW,CAAC,qNAAqN,EAAE,WAAW;gBAC7O,GAAG,KAAK;;;;;;;;;;;;AAIjB"}},
    {"offset": {"line": 132, "column": 0}, "map": {"version":3,"sources":["file:///Users/vijaygopalb/AgentOS/apps/dashboard/src/components/shared/Button.tsx"],"sourcesContent":["\"use client\";\n\nimport type { ButtonHTMLAttributes, ReactNode } from \"react\";\n\ntype ButtonVariant = \"primary\" | \"ghost\" | \"danger\";\n\ninterface ButtonProps extends ButtonHTMLAttributes<HTMLButtonElement> {\n  variant?: ButtonVariant;\n  children: ReactNode;\n}\n\nconst variantStyles: Record<ButtonVariant, string> = {\n  primary:\n    \"bg-gradient-to-r from-accent-blue to-accent-magenta text-white font-medium hover:opacity-90 active:opacity-80\",\n  ghost:\n    \"bg-white/5 text-white/70 hover:bg-white/10 hover:text-white active:bg-white/15\",\n  danger:\n    \"bg-danger/15 text-danger hover:bg-danger/25 active:bg-danger/35\",\n};\n\nexport function Button({\n  variant = \"primary\",\n  children,\n  className = \"\",\n  disabled,\n  ...props\n}: ButtonProps) {\n  return (\n    <button\n      className={`px-4 py-2 rounded-input text-sm transition-all duration-150 disabled:opacity-40 disabled:cursor-not-allowed ${variantStyles[variant]} ${className}`}\n      disabled={disabled}\n      {...props}\n    >\n      {children}\n    </button>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;;AAWA,MAAM,gBAA+C;IACnD,SACE;IACF,OACE;IACF,QACE;AACJ;AAEO,SAAS,OAAO,EACrB,UAAU,SAAS,EACnB,QAAQ,EACR,YAAY,EAAE,EACd,QAAQ,EACR,GAAG,OACS;IACZ,qBACE,6WAAC;QACC,WAAW,CAAC,4GAA4G,EAAE,aAAa,CAAC,QAAQ,CAAC,CAAC,EAAE,WAAW;QAC/J,UAAU;QACT,GAAG,KAAK;kBAER;;;;;;AAGP"}},
    {"offset": {"line": 160, "column": 0}, "map": {"version":3,"sources":["file:///Users/vijaygopalb/AgentOS/apps/dashboard/src/components/shared/EmptyState.tsx"],"sourcesContent":["\"use client\";\n\ninterface EmptyStateProps {\n  message: string;\n  className?: string;\n}\n\nexport function EmptyState({ message, className = \"\" }: EmptyStateProps) {\n  return (\n    <div className={`py-8 text-center text-sm text-white/40 ${className}`}>\n      {message}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;;AAOO,SAAS,WAAW,EAAE,OAAO,EAAE,YAAY,EAAE,EAAmB;IACrE,qBACE,6WAAC;QAAI,WAAW,CAAC,uCAAuC,EAAE,WAAW;kBAClE;;;;;;AAGP"}},
    {"offset": {"line": 181, "column": 0}, "map": {"version":3,"sources":["file:///Users/vijaygopalb/AgentOS/apps/dashboard/src/components/security/GovernancePanel.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, type FormEvent } from \"react\";\nimport type { PolicyInfo, ModerationCase, Sanction, Appeal } from \"@/lib/types\";\nimport { Tag } from \"@/components/shared/Tag\";\nimport { Input } from \"@/components/shared/Input\";\nimport { Button } from \"@/components/shared/Button\";\nimport { EmptyState } from \"@/components/shared/EmptyState\";\n\ninterface GovernancePanelProps {\n  policies: PolicyInfo[];\n  cases: ModerationCase[];\n  sanctions: Sanction[];\n  appeals: Appeal[];\n  onOpenCase: (subjectAgentId: string, policyId?: string, reason?: string) => Promise<void>;\n  onResolveCase: (caseId: string, status?: string, resolution?: string) => Promise<void>;\n  onApplySanction: (subjectAgentId: string, sanctionType: string) => Promise<void>;\n  onLiftSanction: (sanctionId: string) => Promise<void>;\n  onOpenAppeal: (caseId: string, reason?: string) => Promise<void>;\n  onResolveAppeal: (appealId: string, status?: string, resolution?: string) => Promise<void>;\n}\n\nfunction formatEvidence(value: unknown): string {\n  if (!value || typeof value !== \"object\") return \"No evidence\";\n  const keys = Object.keys(value);\n  if (!keys.length) return \"No evidence\";\n  return `Evidence: ${keys.slice(0, 3).join(\", \")}${keys.length > 3 ? \"...\" : \"\"}`;\n}\n\nexport function GovernancePanel({\n  policies,\n  cases,\n  sanctions,\n  appeals,\n  onOpenCase,\n  onResolveCase,\n  onApplySanction,\n  onLiftSanction,\n  onOpenAppeal,\n  onResolveAppeal,\n}: GovernancePanelProps) {\n  const [caseSubject, setCaseSubject] = useState(\"\");\n  const [casePolicy, setCasePolicy] = useState(\"\");\n  const [caseReason, setCaseReason] = useState(\"\");\n  const [sanctionSubject, setSanctionSubject] = useState(\"\");\n  const [sanctionType, setSanctionType] = useState(\"warning\");\n  const [resolveCaseId, setResolveCaseId] = useState(\"\");\n  const [resolveCaseStatus, setResolveCaseStatus] = useState(\"\");\n  const [resolveCaseNotes, setResolveCaseNotes] = useState(\"\");\n  const [liftSanctionId, setLiftSanctionId] = useState(\"\");\n  const [appealCaseId, setAppealCaseId] = useState(\"\");\n  const [appealReason, setAppealReason] = useState(\"\");\n  const [resolveAppealId, setResolveAppealId] = useState(\"\");\n  const [resolveAppealStatus, setResolveAppealStatus] = useState(\"\");\n  const [resolveAppealNotes, setResolveAppealNotes] = useState(\"\");\n\n  const handleOpenCase = async (e: FormEvent) => {\n    e.preventDefault();\n    if (!caseSubject.trim()) return;\n    await onOpenCase(caseSubject.trim(), casePolicy.trim() || undefined, caseReason.trim() || undefined);\n    setCaseSubject(\"\");\n    setCasePolicy(\"\");\n    setCaseReason(\"\");\n  };\n\n  const handleApplySanction = async (e: FormEvent) => {\n    e.preventDefault();\n    if (!sanctionSubject.trim()) return;\n    await onApplySanction(sanctionSubject.trim(), sanctionType);\n    setSanctionSubject(\"\");\n  };\n\n  const handleResolveCase = async (e: FormEvent) => {\n    e.preventDefault();\n    if (!resolveCaseId.trim()) return;\n    await onResolveCase(resolveCaseId.trim(), resolveCaseStatus.trim() || undefined, resolveCaseNotes.trim() || undefined);\n    setResolveCaseId(\"\");\n    setResolveCaseStatus(\"\");\n    setResolveCaseNotes(\"\");\n  };\n\n  const handleLiftSanction = async (e: FormEvent) => {\n    e.preventDefault();\n    if (!liftSanctionId.trim()) return;\n    await onLiftSanction(liftSanctionId.trim());\n    setLiftSanctionId(\"\");\n  };\n\n  const handleOpenAppeal = async (e: FormEvent) => {\n    e.preventDefault();\n    if (!appealCaseId.trim()) return;\n    await onOpenAppeal(appealCaseId.trim(), appealReason.trim() || undefined);\n    setAppealCaseId(\"\");\n    setAppealReason(\"\");\n  };\n\n  const handleResolveAppeal = async (e: FormEvent) => {\n    e.preventDefault();\n    if (!resolveAppealId.trim()) return;\n    await onResolveAppeal(resolveAppealId.trim(), resolveAppealStatus.trim() || undefined, resolveAppealNotes.trim() || undefined);\n    setResolveAppealId(\"\");\n    setResolveAppealStatus(\"\");\n    setResolveAppealNotes(\"\");\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Policies */}\n      <div>\n        <h3 className=\"text-xs font-heading font-semibold text-white/50 uppercase tracking-wider mb-3\">Policies</h3>\n        {policies.length === 0 ? (\n          <EmptyState message=\"No policies\" />\n        ) : (\n          <div className=\"space-y-2\">\n            {policies.map((p) => (\n              <div key={p.id} className=\"glass-card px-3 py-2 flex items-center justify-between\">\n                <div>\n                  <span className=\"text-sm font-medium text-white\">{p.name}</span>\n                  <Tag variant={p.status === \"active\" ? \"success\" : \"default\"} className=\"ml-2\">{p.status || \"active\"}</Tag>\n                </div>\n                <span className=\"text-2xs text-white/30\">{p.id}</span>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Cases */}\n      <div>\n        <h3 className=\"text-xs font-heading font-semibold text-white/50 uppercase tracking-wider mb-3\">Moderation Cases</h3>\n        {cases.length === 0 ? (\n          <EmptyState message=\"No cases\" />\n        ) : (\n          <div className=\"space-y-2\">\n            {cases.map((c) => (\n              <div key={c.id} className=\"glass-card px-3 py-2\">\n                <div className=\"flex items-center gap-2\">\n                  <span className=\"text-sm font-medium text-white\">{c.id}</span>\n                  <Tag variant={c.status === \"open\" ? \"warning\" : \"default\"}>{c.status}</Tag>\n                </div>\n                <div className=\"text-2xs text-white/40 mt-1\">\n                  {c.reason || \"No reason\"} | {formatEvidence(c.evidence)}\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n        <form onSubmit={handleOpenCase} className=\"mt-3 flex gap-2 items-end\">\n          <Input label=\"Subject Agent\" value={caseSubject} onChange={(e) => setCaseSubject(e.target.value)} placeholder=\"agent-id\" />\n          <Input label=\"Policy ID\" value={casePolicy} onChange={(e) => setCasePolicy(e.target.value)} placeholder=\"optional\" />\n          <Input label=\"Reason\" value={caseReason} onChange={(e) => setCaseReason(e.target.value)} placeholder=\"optional\" />\n          <Button type=\"submit\" disabled={!caseSubject.trim()}>Open Case</Button>\n        </form>\n        <form onSubmit={handleResolveCase} className=\"mt-2 flex gap-2 items-end\">\n          <Input label=\"Case ID\" value={resolveCaseId} onChange={(e) => setResolveCaseId(e.target.value)} placeholder=\"case-id\" />\n          <Input label=\"Status\" value={resolveCaseStatus} onChange={(e) => setResolveCaseStatus(e.target.value)} placeholder=\"resolved\" />\n          <Input label=\"Notes\" value={resolveCaseNotes} onChange={(e) => setResolveCaseNotes(e.target.value)} placeholder=\"optional\" />\n          <Button type=\"submit\" variant=\"ghost\" disabled={!resolveCaseId.trim()}>Resolve</Button>\n        </form>\n      </div>\n\n      {/* Sanctions */}\n      <div>\n        <h3 className=\"text-xs font-heading font-semibold text-white/50 uppercase tracking-wider mb-3\">Sanctions</h3>\n        {sanctions.length === 0 ? (\n          <EmptyState message=\"No sanctions\" />\n        ) : (\n          <div className=\"space-y-2\">\n            {sanctions.map((s) => (\n              <div key={s.id} className=\"glass-card px-3 py-2 flex items-center justify-between\">\n                <div>\n                  <span className=\"text-sm text-white\">{s.type}</span>\n                  <span className=\"text-2xs text-white/30 ml-2\">{s.subject_agent_id || \"—\"}</span>\n                </div>\n                <span className=\"text-2xs text-white/30\">{s.id}</span>\n              </div>\n            ))}\n          </div>\n        )}\n        <form onSubmit={handleApplySanction} className=\"mt-3 flex gap-2 items-end\">\n          <Input label=\"Subject Agent\" value={sanctionSubject} onChange={(e) => setSanctionSubject(e.target.value)} placeholder=\"agent-id\" />\n          <div className=\"flex flex-col gap-1.5\">\n            <label className=\"text-xs text-white/50 font-medium\">Type</label>\n            <select value={sanctionType} onChange={(e) => setSanctionType(e.target.value)} className=\"bg-white/5 border border-surface-border rounded-input px-3 py-2 text-sm text-white\">\n              <option value=\"warning\" className=\"bg-navy-800\">Warning</option>\n              <option value=\"quarantine\" className=\"bg-navy-800\">Quarantine</option>\n              <option value=\"suspension\" className=\"bg-navy-800\">Suspension</option>\n              <option value=\"ban\" className=\"bg-navy-800\">Ban</option>\n            </select>\n          </div>\n          <Button type=\"submit\" disabled={!sanctionSubject.trim()}>Apply</Button>\n        </form>\n        <form onSubmit={handleLiftSanction} className=\"mt-2 flex gap-2 items-end\">\n          <Input label=\"Sanction ID\" value={liftSanctionId} onChange={(e) => setLiftSanctionId(e.target.value)} placeholder=\"sanction-id\" />\n          <Button type=\"submit\" variant=\"ghost\" disabled={!liftSanctionId.trim()}>Lift</Button>\n        </form>\n      </div>\n\n      {/* Appeals */}\n      <div>\n        <h3 className=\"text-xs font-heading font-semibold text-white/50 uppercase tracking-wider mb-3\">Appeals</h3>\n        {appeals.length === 0 ? (\n          <EmptyState message=\"No appeals\" />\n        ) : (\n          <div className=\"space-y-2\">\n            {appeals.map((a) => (\n              <div key={a.id} className=\"glass-card px-3 py-2\">\n                <div className=\"flex items-center gap-2\">\n                  <span className=\"text-sm text-white\">{a.id}</span>\n                  <Tag variant={a.status === \"open\" ? \"warning\" : \"default\"}>{a.status}</Tag>\n                </div>\n                <div className=\"text-2xs text-white/40 mt-1\">\n                  {a.resolution || \"No resolution\"} | {formatEvidence(a.evidence)}\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n        <form onSubmit={handleOpenAppeal} className=\"mt-3 flex gap-2 items-end\">\n          <Input label=\"Case ID\" value={appealCaseId} onChange={(e) => setAppealCaseId(e.target.value)} placeholder=\"case-id\" />\n          <Input label=\"Reason\" value={appealReason} onChange={(e) => setAppealReason(e.target.value)} placeholder=\"optional\" />\n          <Button type=\"submit\" disabled={!appealCaseId.trim()}>Open Appeal</Button>\n        </form>\n        <form onSubmit={handleResolveAppeal} className=\"mt-2 flex gap-2 items-end\">\n          <Input label=\"Appeal ID\" value={resolveAppealId} onChange={(e) => setResolveAppealId(e.target.value)} placeholder=\"appeal-id\" />\n          <Input label=\"Status\" value={resolveAppealStatus} onChange={(e) => setResolveAppealStatus(e.target.value)} placeholder=\"resolved\" />\n          <Input label=\"Notes\" value={resolveAppealNotes} onChange={(e) => setResolveAppealNotes(e.target.value)} placeholder=\"optional\" />\n          <Button type=\"submit\" variant=\"ghost\" disabled={!resolveAppealId.trim()}>Resolve</Button>\n        </form>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 878, "column": 0}, "map": {"version":3,"sources":["file:///Users/vijaygopalb/AgentOS/apps/dashboard/src/components/security/AuditLog.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, type FormEvent } from \"react\";\nimport type { AuditEntry } from \"@/lib/types\";\nimport { Input } from \"@/components/shared/Input\";\nimport { Button } from \"@/components/shared/Button\";\nimport { EmptyState } from \"@/components/shared/EmptyState\";\n\ninterface AuditLogProps {\n  entries: AuditEntry[];\n  loading?: boolean;\n  onQuery: (filters?: { action?: string; actorId?: string; limit?: number }) => void;\n}\n\nexport function AuditLog({ entries, loading, onQuery }: AuditLogProps) {\n  const [action, setAction] = useState(\"\");\n  const [actorId, setActorId] = useState(\"\");\n  const [limit, setLimit] = useState(\"50\");\n\n  const handleSearch = (e: FormEvent) => {\n    e.preventDefault();\n    onQuery({\n      action: action.trim() || undefined,\n      actorId: actorId.trim() || undefined,\n      limit: Number(limit) || 50,\n    });\n  };\n\n  return (\n    <div>\n      <form onSubmit={handleSearch} className=\"flex gap-2 items-end mb-4\">\n        <Input label=\"Action\" value={action} onChange={(e) => setAction(e.target.value)} placeholder=\"filter by action\" />\n        <Input label=\"Actor ID\" value={actorId} onChange={(e) => setActorId(e.target.value)} placeholder=\"filter by actor\" />\n        <div className=\"w-20\">\n          <Input label=\"Limit\" type=\"number\" value={limit} onChange={(e) => setLimit(e.target.value)} />\n        </div>\n        <Button type=\"submit\" disabled={loading}>\n          {loading ? \"Loading...\" : \"Query\"}\n        </Button>\n      </form>\n\n      {entries.length === 0 ? (\n        <EmptyState message=\"No audit entries\" />\n      ) : (\n        <div className=\"space-y-2 max-h-96 overflow-y-auto\">\n          {entries.map((entry, i) => (\n            <div key={entry.id || i} className=\"glass-card px-3 py-2\">\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-sm font-medium text-white\">{entry.action}</span>\n                <span className=\"text-2xs text-white/30\">\n                  {new Date(entry.created_at).toLocaleString()}\n                </span>\n              </div>\n              <div className=\"text-2xs text-white/40 mt-0.5\">\n                Actor: {entry.actor_id || \"—\"} | Resource: {entry.resource_type || \"—\"} | Outcome: {entry.outcome}\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAEA;AACA;AACA;AANA;;;;;;AAcO,SAAS,SAAS,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,EAAiB;IACnE,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,gVAAQ,EAAC;IACrC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,gVAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,gVAAQ,EAAC;IAEnC,MAAM,eAAe,CAAC;QACpB,EAAE,cAAc;QAChB,QAAQ;YACN,QAAQ,OAAO,IAAI,MAAM;YACzB,SAAS,QAAQ,IAAI,MAAM;YAC3B,OAAO,OAAO,UAAU;QAC1B;IACF;IAEA,qBACE,6WAAC;;0BACC,6WAAC;gBAAK,UAAU;gBAAc,WAAU;;kCACtC,6WAAC,mKAAK;wBAAC,OAAM;wBAAS,OAAO;wBAAQ,UAAU,CAAC,IAAM,UAAU,EAAE,MAAM,CAAC,KAAK;wBAAG,aAAY;;;;;;kCAC7F,6WAAC,mKAAK;wBAAC,OAAM;wBAAW,OAAO;wBAAS,UAAU,CAAC,IAAM,WAAW,EAAE,MAAM,CAAC,KAAK;wBAAG,aAAY;;;;;;kCACjG,6WAAC;wBAAI,WAAU;kCACb,cAAA,6WAAC,mKAAK;4BAAC,OAAM;4BAAQ,MAAK;4BAAS,OAAO;4BAAO,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;kCAE3F,6WAAC,qKAAM;wBAAC,MAAK;wBAAS,UAAU;kCAC7B,UAAU,eAAe;;;;;;;;;;;;YAI7B,QAAQ,MAAM,KAAK,kBAClB,6WAAC,6KAAU;gBAAC,SAAQ;;;;;qCAEpB,6WAAC;gBAAI,WAAU;0BACZ,QAAQ,GAAG,CAAC,CAAC,OAAO,kBACnB,6WAAC;wBAAwB,WAAU;;0CACjC,6WAAC;gCAAI,WAAU;;kDACb,6WAAC;wCAAK,WAAU;kDAAkC,MAAM,MAAM;;;;;;kDAC9D,6WAAC;wCAAK,WAAU;kDACb,IAAI,KAAK,MAAM,UAAU,EAAE,cAAc;;;;;;;;;;;;0CAG9C,6WAAC;gCAAI,WAAU;;oCAAgC;oCACrC,MAAM,QAAQ,IAAI;oCAAI;oCAAc,MAAM,aAAa,IAAI;oCAAI;oCAAa,MAAM,OAAO;;;;;;;;uBAR3F,MAAM,EAAE,IAAI;;;;;;;;;;;;;;;;AAgBlC"}},
    {"offset": {"line": 1036, "column": 0}, "map": {"version":3,"sources":["file:///Users/vijaygopalb/AgentOS/apps/dashboard/src/components/security/CapabilityManager.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, type FormEvent } from \"react\";\nimport type { CapabilityToken } from \"@/lib/types\";\nimport { Input } from \"@/components/shared/Input\";\nimport { Button } from \"@/components/shared/Button\";\nimport { EmptyState } from \"@/components/shared/EmptyState\";\n\ninterface CapabilityManagerProps {\n  tokens: CapabilityToken[];\n  loading?: boolean;\n  onList: (agentId?: string) => void;\n  onGrant: (agentId: string, permissions: string[], purpose?: string, durationMs?: number) => Promise<void>;\n  onRevoke: (tokenId: string) => Promise<void>;\n  onRevokeAll: (agentId: string) => Promise<void>;\n}\n\nexport function CapabilityManager({\n  tokens,\n  loading,\n  onList,\n  onGrant,\n  onRevoke,\n  onRevokeAll,\n}: CapabilityManagerProps) {\n  const [agentId, setAgentId] = useState(\"\");\n  const [permissions, setPermissions] = useState(\"\");\n  const [purpose, setPurpose] = useState(\"\");\n  const [duration, setDuration] = useState(\"\");\n  const [revokeTokenId, setRevokeTokenId] = useState(\"\");\n\n  const handleList = () => onList(agentId.trim() || undefined);\n\n  const handleGrant = async (e: FormEvent) => {\n    e.preventDefault();\n    if (!agentId.trim() || !permissions.trim()) return;\n    const perms = permissions.split(/[\\n,]/).map((p) => p.trim()).filter(Boolean);\n    const dur = Number(duration);\n    await onGrant(agentId.trim(), perms, purpose.trim() || undefined, dur > 0 ? dur : undefined);\n    setPermissions(\"\");\n    setPurpose(\"\");\n    setDuration(\"\");\n  };\n\n  const handleRevoke = async (e: FormEvent) => {\n    e.preventDefault();\n    if (!revokeTokenId.trim()) return;\n    await onRevoke(revokeTokenId.trim());\n    setRevokeTokenId(\"\");\n  };\n\n  const handleRevokeAll = async () => {\n    if (!agentId.trim()) return;\n    await onRevokeAll(agentId.trim());\n  };\n\n  const formatPerms = (token: CapabilityToken) => {\n    if (!Array.isArray(token.permissions)) return \"—\";\n    return token.permissions\n      .map((p) => `${p.category}.${p.actions?.join(\"|\") || \"*\"}${p.resource ? `:${p.resource}` : \"\"}`)\n      .join(\", \");\n  };\n\n  return (\n    <div>\n      <div className=\"flex gap-2 items-end mb-4\">\n        <Input label=\"Agent ID\" value={agentId} onChange={(e) => setAgentId(e.target.value)} placeholder=\"agent-id\" />\n        <Button onClick={handleList} disabled={loading}>\n          {loading ? \"Loading...\" : \"List Tokens\"}\n        </Button>\n        <Button variant=\"danger\" onClick={handleRevokeAll} disabled={!agentId.trim()}>\n          Revoke All\n        </Button>\n      </div>\n\n      {tokens.length === 0 ? (\n        <EmptyState message=\"No capability tokens\" />\n      ) : (\n        <div className=\"space-y-2 mb-6 max-h-64 overflow-y-auto\">\n          {tokens.map((token) => (\n            <div key={token.id} className=\"glass-card px-3 py-2\">\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-sm font-medium text-white\">{token.id}</span>\n                <Button variant=\"ghost\" onClick={() => onRevoke(token.id)} className=\"text-xs\">\n                  Revoke\n                </Button>\n              </div>\n              <div className=\"text-2xs text-white/40 mt-0.5\">\n                Agent: {token.agentId} | Expires: {token.expiresAt ? new Date(token.expiresAt).toLocaleString() : \"—\"}\n              </div>\n              <div className=\"text-2xs text-white/30 mt-0.5\">{formatPerms(token)}</div>\n            </div>\n          ))}\n        </div>\n      )}\n\n      <div className=\"border-t border-surface-border pt-4 mt-4\">\n        <h4 className=\"text-xs font-heading text-white/50 uppercase mb-3\">Grant Token</h4>\n        <form onSubmit={handleGrant} className=\"space-y-2\">\n          <Input label=\"Permissions (comma-separated)\" value={permissions} onChange={(e) => setPermissions(e.target.value)} placeholder=\"memory.read, llm.execute\" />\n          <div className=\"flex gap-2 items-end\">\n            <Input label=\"Purpose\" value={purpose} onChange={(e) => setPurpose(e.target.value)} placeholder=\"optional\" />\n            <div className=\"w-40\">\n              <Input label=\"Duration (ms)\" type=\"number\" value={duration} onChange={(e) => setDuration(e.target.value)} placeholder=\"optional\" />\n            </div>\n            <Button type=\"submit\" disabled={!agentId.trim() || !permissions.trim()}>Grant</Button>\n          </div>\n        </form>\n      </div>\n\n      <div className=\"border-t border-surface-border pt-4 mt-4\">\n        <h4 className=\"text-xs font-heading text-white/50 uppercase mb-3\">Revoke by ID</h4>\n        <form onSubmit={handleRevoke} className=\"flex gap-2 items-end\">\n          <Input label=\"Token ID\" value={revokeTokenId} onChange={(e) => setRevokeTokenId(e.target.value)} placeholder=\"token-id\" />\n          <Button type=\"submit\" variant=\"danger\" disabled={!revokeTokenId.trim()}>Revoke</Button>\n        </form>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1333, "column": 0}, "map": {"version":3,"sources":["file:///Users/vijaygopalb/AgentOS/apps/dashboard/src/components/security/IncidentPanel.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { Input } from \"@/components/shared/Input\";\nimport { Button } from \"@/components/shared/Button\";\nimport { useWebSocket } from \"@/hooks/useWebSocket\";\n\nexport function IncidentPanel() {\n  const { sendAgentTask, operatorAgentId } = useWebSocket();\n  const [policyName, setPolicyName] = useState(\"Global Lockdown\");\n  const [statusMessage, setStatusMessage] = useState<string | null>(null);\n  const [working, setWorking] = useState(false);\n\n  const task = async (taskData: Record<string, unknown>) => {\n    if (!operatorAgentId) throw new Error(\"Set operator agent first\");\n    return sendAgentTask(operatorAgentId, taskData);\n  };\n\n  const getLockdownPolicy = async (name: string) => {\n    const result = (await task({ type: \"policy_list\", limit: 100 })) as {\n      policies?: Array<{ id: string; name: string }>;\n    };\n    return result?.policies?.find((p) => p.name === name);\n  };\n\n  const ensureLockdownPolicy = async (name: string) => {\n    const existing = await getLockdownPolicy(name);\n    if (existing) return existing;\n    const result = (await task({\n      type: \"policy_create\",\n      name,\n      description: \"Global incident lockdown policy\",\n      rules: {\n        rules: [\n          {\n            type: \"deny\",\n            action: \"tool.invoked\",\n            resourceType: \"tool\",\n            reason: \"Incident lockdown active\",\n            sanction: { type: \"quarantine\" },\n          },\n        ],\n      },\n    })) as { policy?: { id: string; name: string } };\n    return result?.policy;\n  };\n\n  const enableLockdown = async () => {\n    setWorking(true);\n    setStatusMessage(null);\n    try {\n      const policy = await ensureLockdownPolicy(policyName.trim() || \"Global Lockdown\");\n      if (policy?.id) {\n        await task({ type: \"policy_set_status\", policyId: policy.id, status: \"active\" });\n        setStatusMessage(`Lockdown enabled (${policy.id})`);\n      }\n    } catch (err) {\n      setStatusMessage(`Error: ${err instanceof Error ? err.message : \"Failed\"}`);\n    } finally {\n      setWorking(false);\n    }\n  };\n\n  const disableLockdown = async () => {\n    setWorking(true);\n    setStatusMessage(null);\n    try {\n      const policy = await getLockdownPolicy(policyName.trim() || \"Global Lockdown\");\n      if (!policy?.id) {\n        setStatusMessage(\"No policy found\");\n        return;\n      }\n      await task({ type: \"policy_set_status\", policyId: policy.id, status: \"inactive\" });\n      setStatusMessage(`Lockdown disabled (${policy.id})`);\n    } catch (err) {\n      setStatusMessage(`Error: ${err instanceof Error ? err.message : \"Failed\"}`);\n    } finally {\n      setWorking(false);\n    }\n  };\n\n  return (\n    <div>\n      <div className=\"flex gap-2 items-end mb-4\">\n        <Input\n          label=\"Policy Name\"\n          value={policyName}\n          onChange={(e) => setPolicyName(e.target.value)}\n          placeholder=\"Global Lockdown\"\n        />\n        <Button onClick={enableLockdown} disabled={working}>\n          {working ? \"Working...\" : \"Enable Lockdown\"}\n        </Button>\n        <Button variant=\"ghost\" onClick={disableLockdown} disabled={working}>\n          Disable Lockdown\n        </Button>\n      </div>\n      {statusMessage && (\n        <div\n          className={`text-xs ${statusMessage.startsWith(\"Error\") ? \"text-danger\" : \"text-success\"}`}\n        >\n          {statusMessage}\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AALA;;;;;;AAOO,SAAS;IACd,MAAM,EAAE,aAAa,EAAE,eAAe,EAAE,GAAG,IAAA,iKAAY;IACvD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,gVAAQ,EAAC;IAC7C,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,gVAAQ,EAAgB;IAClE,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,gVAAQ,EAAC;IAEvC,MAAM,OAAO,OAAO;QAClB,IAAI,CAAC,iBAAiB,MAAM,IAAI,MAAM;QACtC,OAAO,cAAc,iBAAiB;IACxC;IAEA,MAAM,oBAAoB,OAAO;QAC/B,MAAM,SAAU,MAAM,KAAK;YAAE,MAAM;YAAe,OAAO;QAAI;QAG7D,OAAO,QAAQ,UAAU,KAAK,CAAC,IAAM,EAAE,IAAI,KAAK;IAClD;IAEA,MAAM,uBAAuB,OAAO;QAClC,MAAM,WAAW,MAAM,kBAAkB;QACzC,IAAI,UAAU,OAAO;QACrB,MAAM,SAAU,MAAM,KAAK;YACzB,MAAM;YACN;YACA,aAAa;YACb,OAAO;gBACL,OAAO;oBACL;wBACE,MAAM;wBACN,QAAQ;wBACR,cAAc;wBACd,QAAQ;wBACR,UAAU;4BAAE,MAAM;wBAAa;oBACjC;iBACD;YACH;QACF;QACA,OAAO,QAAQ;IACjB;IAEA,MAAM,iBAAiB;QACrB,WAAW;QACX,iBAAiB;QACjB,IAAI;YACF,MAAM,SAAS,MAAM,qBAAqB,WAAW,IAAI,MAAM;YAC/D,IAAI,QAAQ,IAAI;gBACd,MAAM,KAAK;oBAAE,MAAM;oBAAqB,UAAU,OAAO,EAAE;oBAAE,QAAQ;gBAAS;gBAC9E,iBAAiB,CAAC,kBAAkB,EAAE,OAAO,EAAE,CAAC,CAAC,CAAC;YACpD;QACF,EAAE,OAAO,KAAK;YACZ,iBAAiB,CAAC,OAAO,EAAE,eAAe,QAAQ,IAAI,OAAO,GAAG,UAAU;QAC5E,SAAU;YACR,WAAW;QACb;IACF;IAEA,MAAM,kBAAkB;QACtB,WAAW;QACX,iBAAiB;QACjB,IAAI;YACF,MAAM,SAAS,MAAM,kBAAkB,WAAW,IAAI,MAAM;YAC5D,IAAI,CAAC,QAAQ,IAAI;gBACf,iBAAiB;gBACjB;YACF;YACA,MAAM,KAAK;gBAAE,MAAM;gBAAqB,UAAU,OAAO,EAAE;gBAAE,QAAQ;YAAW;YAChF,iBAAiB,CAAC,mBAAmB,EAAE,OAAO,EAAE,CAAC,CAAC,CAAC;QACrD,EAAE,OAAO,KAAK;YACZ,iBAAiB,CAAC,OAAO,EAAE,eAAe,QAAQ,IAAI,OAAO,GAAG,UAAU;QAC5E,SAAU;YACR,WAAW;QACb;IACF;IAEA,qBACE,6WAAC;;0BACC,6WAAC;gBAAI,WAAU;;kCACb,6WAAC,mKAAK;wBACJ,OAAM;wBACN,OAAO;wBACP,UAAU,CAAC,IAAM,cAAc,EAAE,MAAM,CAAC,KAAK;wBAC7C,aAAY;;;;;;kCAEd,6WAAC,qKAAM;wBAAC,SAAS;wBAAgB,UAAU;kCACxC,UAAU,eAAe;;;;;;kCAE5B,6WAAC,qKAAM;wBAAC,SAAQ;wBAAQ,SAAS;wBAAiB,UAAU;kCAAS;;;;;;;;;;;;YAItE,+BACC,6WAAC;gBACC,WAAW,CAAC,QAAQ,EAAE,cAAc,UAAU,CAAC,WAAW,gBAAgB,gBAAgB;0BAEzF;;;;;;;;;;;;AAKX"}},
    {"offset": {"line": 1486, "column": 0}, "map": {"version":3,"sources":["file:///Users/vijaygopalb/AgentOS/apps/dashboard/src/hooks/useGovernance.ts"],"sourcesContent":["\"use client\";\n\nimport { useState, useCallback } from \"react\";\nimport type {\n  PolicyInfo,\n  ModerationCase,\n  Sanction,\n  Appeal,\n} from \"@/lib/types\";\nimport { useWebSocket } from \"./useWebSocket\";\n\ninterface GovernanceData {\n  policies: PolicyInfo[];\n  cases: ModerationCase[];\n  sanctions: Sanction[];\n  appeals: Appeal[];\n}\n\nexport function useGovernance() {\n  const { sendAgentTask, operatorAgentId } = useWebSocket();\n  const [data, setData] = useState<GovernanceData>({\n    policies: [],\n    cases: [],\n    sanctions: [],\n    appeals: [],\n  });\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const task = useCallback(\n    async (taskData: Record<string, unknown>) => {\n      if (!operatorAgentId) throw new Error(\"Set operator agent first\");\n      return sendAgentTask(operatorAgentId, taskData);\n    },\n    [sendAgentTask, operatorAgentId]\n  );\n\n  const refresh = useCallback(async () => {\n    if (!operatorAgentId) return;\n    setLoading(true);\n    setError(null);\n    try {\n      const [policies, cases, sanctions, appeals] = await Promise.all([\n        task({ type: \"policy_list\", limit: 50 }),\n        task({ type: \"moderation_case_list\", limit: 50 }),\n        task({ type: \"sanction_list\", limit: 50 }),\n        task({ type: \"appeal_list\", limit: 50 }),\n      ]);\n      setData({\n        policies: (policies as { policies?: PolicyInfo[] })?.policies ?? [],\n        cases: (cases as { cases?: ModerationCase[] })?.cases ?? [],\n        sanctions:\n          (sanctions as { sanctions?: Sanction[] })?.sanctions ?? [],\n        appeals: (appeals as { appeals?: Appeal[] })?.appeals ?? [],\n      });\n    } catch (err) {\n      setError(err instanceof Error ? err.message : \"Failed to fetch\");\n    } finally {\n      setLoading(false);\n    }\n  }, [task, operatorAgentId]);\n\n  const openCase = useCallback(\n    async (subjectAgentId: string, policyId?: string, reason?: string) => {\n      await task({\n        type: \"moderation_case_open\",\n        subjectAgentId,\n        ...(policyId && { policyId }),\n        ...(reason && { reason }),\n      });\n      await refresh();\n    },\n    [task, refresh]\n  );\n\n  const resolveCase = useCallback(\n    async (caseId: string, status?: string, resolution?: string) => {\n      await task({\n        type: \"moderation_case_resolve\",\n        caseId,\n        ...(status && { status }),\n        ...(resolution && { resolution }),\n      });\n      await refresh();\n    },\n    [task, refresh]\n  );\n\n  const applySanction = useCallback(\n    async (subjectAgentId: string, sanctionType: string) => {\n      await task({ type: \"sanction_apply\", subjectAgentId, sanctionType });\n      await refresh();\n    },\n    [task, refresh]\n  );\n\n  const liftSanction = useCallback(\n    async (sanctionId: string) => {\n      await task({ type: \"sanction_lift\", sanctionId });\n      await refresh();\n    },\n    [task, refresh]\n  );\n\n  const openAppeal = useCallback(\n    async (caseId: string, reason?: string) => {\n      await task({\n        type: \"appeal_open\",\n        caseId,\n        ...(reason && { reason }),\n      });\n      await refresh();\n    },\n    [task, refresh]\n  );\n\n  const resolveAppeal = useCallback(\n    async (appealId: string, status?: string, resolution?: string) => {\n      await task({\n        type: \"appeal_resolve\",\n        appealId,\n        ...(status && { status }),\n        ...(resolution && { resolution }),\n      });\n      await refresh();\n    },\n    [task, refresh]\n  );\n\n  return {\n    ...data,\n    loading,\n    error,\n    refresh,\n    openCase,\n    resolveCase,\n    applySanction,\n    liftSanction,\n    openAppeal,\n    resolveAppeal,\n  };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1649, "column": 0}, "map": {"version":3,"sources":["file:///Users/vijaygopalb/AgentOS/apps/dashboard/src/hooks/useAudit.ts"],"sourcesContent":["\"use client\";\n\nimport { useState, useCallback } from \"react\";\nimport type { AuditEntry } from \"@/lib/types\";\nimport { useWebSocket } from \"./useWebSocket\";\n\nexport function useAudit() {\n  const { sendAgentTask, operatorAgentId } = useWebSocket();\n  const [entries, setEntries] = useState<AuditEntry[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const query = useCallback(\n    async (filters?: { action?: string; actorId?: string; limit?: number }) => {\n      if (!operatorAgentId) {\n        setError(\"Set operator agent first\");\n        return;\n      }\n      setLoading(true);\n      setError(null);\n      try {\n        const result = (await sendAgentTask(operatorAgentId, {\n          type: \"audit_query\",\n          ...(filters?.action && { action: filters.action }),\n          ...(filters?.actorId && { actorId: filters.actorId }),\n          limit: filters?.limit || 50,\n        })) as { entries?: AuditEntry[] };\n        setEntries(result?.entries ?? []);\n      } catch (err) {\n        setError(err instanceof Error ? err.message : \"Audit query failed\");\n      } finally {\n        setLoading(false);\n      }\n    },\n    [sendAgentTask, operatorAgentId]\n  );\n\n  return { entries, loading, error, query };\n}\n"],"names":[],"mappings":";;;;AAEA;AAEA;AAJA;;;AAMO,SAAS;IACd,MAAM,EAAE,aAAa,EAAE,eAAe,EAAE,GAAG,IAAA,iKAAY;IACvD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,gVAAQ,EAAe,EAAE;IACvD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,gVAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,gVAAQ,EAAgB;IAElD,MAAM,QAAQ,IAAA,mVAAW,EACvB,OAAO;QACL,IAAI,CAAC,iBAAiB;YACpB,SAAS;YACT;QACF;QACA,WAAW;QACX,SAAS;QACT,IAAI;YACF,MAAM,SAAU,MAAM,cAAc,iBAAiB;gBACnD,MAAM;gBACN,GAAI,SAAS,UAAU;oBAAE,QAAQ,QAAQ,MAAM;gBAAC,CAAC;gBACjD,GAAI,SAAS,WAAW;oBAAE,SAAS,QAAQ,OAAO;gBAAC,CAAC;gBACpD,OAAO,SAAS,SAAS;YAC3B;YACA,WAAW,QAAQ,WAAW,EAAE;QAClC,EAAE,OAAO,KAAK;YACZ,SAAS,eAAe,QAAQ,IAAI,OAAO,GAAG;QAChD,SAAU;YACR,WAAW;QACb;IACF,GACA;QAAC;QAAe;KAAgB;IAGlC,OAAO;QAAE;QAAS;QAAS;QAAO;IAAM;AAC1C"}},
    {"offset": {"line": 1702, "column": 0}, "map": {"version":3,"sources":["file:///Users/vijaygopalb/AgentOS/apps/dashboard/src/hooks/useCapabilities.ts"],"sourcesContent":["\"use client\";\n\nimport { useState, useCallback } from \"react\";\nimport type { CapabilityToken } from \"@/lib/types\";\nimport { useWebSocket } from \"./useWebSocket\";\n\nexport function useCapabilities() {\n  const { sendAgentTask, operatorAgentId } = useWebSocket();\n  const [tokens, setTokens] = useState<CapabilityToken[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const task = useCallback(\n    async (taskData: Record<string, unknown>) => {\n      if (!operatorAgentId) throw new Error(\"Set operator agent first\");\n      return sendAgentTask(operatorAgentId, taskData);\n    },\n    [sendAgentTask, operatorAgentId]\n  );\n\n  const listTokens = useCallback(\n    async (agentId?: string) => {\n      setLoading(true);\n      setError(null);\n      try {\n        const result = (await task({\n          type: \"capability_list\",\n          agentId: agentId || operatorAgentId,\n        })) as { tokens?: CapabilityToken[] };\n        setTokens(result?.tokens ?? []);\n      } catch (err) {\n        setError(err instanceof Error ? err.message : \"Failed to list tokens\");\n      } finally {\n        setLoading(false);\n      }\n    },\n    [task, operatorAgentId]\n  );\n\n  const grant = useCallback(\n    async (\n      agentId: string,\n      permissions: string[],\n      purpose?: string,\n      durationMs?: number\n    ) => {\n      await task({\n        type: \"capability_grant\",\n        agentId,\n        permissions,\n        ...(purpose && { purpose }),\n        ...(durationMs && { durationMs }),\n      });\n      await listTokens(agentId);\n    },\n    [task, listTokens]\n  );\n\n  const revoke = useCallback(\n    async (tokenId: string) => {\n      await task({ type: \"capability_revoke\", tokenId });\n      await listTokens();\n    },\n    [task, listTokens]\n  );\n\n  const revokeAll = useCallback(\n    async (agentId: string) => {\n      await task({ type: \"capability_revoke_all\", agentId });\n      await listTokens(agentId);\n    },\n    [task, listTokens]\n  );\n\n  return { tokens, loading, error, listTokens, grant, revoke, revokeAll };\n}\n"],"names":[],"mappings":";;;;AAEA;AAEA;AAJA;;;AAMO,SAAS;IACd,MAAM,EAAE,aAAa,EAAE,eAAe,EAAE,GAAG,IAAA,iKAAY;IACvD,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,gVAAQ,EAAoB,EAAE;IAC1D,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,gVAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,gVAAQ,EAAgB;IAElD,MAAM,OAAO,IAAA,mVAAW,EACtB,OAAO;QACL,IAAI,CAAC,iBAAiB,MAAM,IAAI,MAAM;QACtC,OAAO,cAAc,iBAAiB;IACxC,GACA;QAAC;QAAe;KAAgB;IAGlC,MAAM,aAAa,IAAA,mVAAW,EAC5B,OAAO;QACL,WAAW;QACX,SAAS;QACT,IAAI;YACF,MAAM,SAAU,MAAM,KAAK;gBACzB,MAAM;gBACN,SAAS,WAAW;YACtB;YACA,UAAU,QAAQ,UAAU,EAAE;QAChC,EAAE,OAAO,KAAK;YACZ,SAAS,eAAe,QAAQ,IAAI,OAAO,GAAG;QAChD,SAAU;YACR,WAAW;QACb;IACF,GACA;QAAC;QAAM;KAAgB;IAGzB,MAAM,QAAQ,IAAA,mVAAW,EACvB,OACE,SACA,aACA,SACA;QAEA,MAAM,KAAK;YACT,MAAM;YACN;YACA;YACA,GAAI,WAAW;gBAAE;YAAQ,CAAC;YAC1B,GAAI,cAAc;gBAAE;YAAW,CAAC;QAClC;QACA,MAAM,WAAW;IACnB,GACA;QAAC;QAAM;KAAW;IAGpB,MAAM,SAAS,IAAA,mVAAW,EACxB,OAAO;QACL,MAAM,KAAK;YAAE,MAAM;YAAqB;QAAQ;QAChD,MAAM;IACR,GACA;QAAC;QAAM;KAAW;IAGpB,MAAM,YAAY,IAAA,mVAAW,EAC3B,OAAO;QACL,MAAM,KAAK;YAAE,MAAM;YAAyB;QAAQ;QACpD,MAAM,WAAW;IACnB,GACA;QAAC;QAAM;KAAW;IAGpB,OAAO;QAAE;QAAQ;QAAS;QAAO;QAAY;QAAO;QAAQ;IAAU;AACxE"}},
    {"offset": {"line": 1792, "column": 0}, "map": {"version":3,"sources":["file:///Users/vijaygopalb/AgentOS/apps/dashboard/src/app/security/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { PageHeader } from \"@/components/layout/PageHeader\";\nimport { Panel } from \"@/components/shared/Panel\";\nimport { GovernancePanel } from \"@/components/security/GovernancePanel\";\nimport { AuditLog } from \"@/components/security/AuditLog\";\nimport { CapabilityManager } from \"@/components/security/CapabilityManager\";\nimport { IncidentPanel } from \"@/components/security/IncidentPanel\";\nimport { useGovernance } from \"@/hooks/useGovernance\";\nimport { useAudit } from \"@/hooks/useAudit\";\nimport { useCapabilities } from \"@/hooks/useCapabilities\";\nimport { useWebSocket } from \"@/hooks/useWebSocket\";\n\ntype SecurityTab = \"governance\" | \"audit\" | \"capabilities\" | \"incident\";\n\nexport default function SecurityPage() {\n  const [activeTab, setActiveTab] = useState<SecurityTab>(\"governance\");\n  const { status, operatorAgentId } = useWebSocket();\n\n  const governance = useGovernance();\n  const audit = useAudit();\n  const capabilities = useCapabilities();\n\n  useEffect(() => {\n    if (status === \"connected\" && operatorAgentId) {\n      governance.refresh();\n    }\n  }, [status, operatorAgentId]);\n\n  const tabs: { id: SecurityTab; label: string }[] = [\n    { id: \"governance\", label: \"Governance\" },\n    { id: \"audit\", label: \"Audit Log\" },\n    { id: \"capabilities\", label: \"Capabilities\" },\n    { id: \"incident\", label: \"Incident\" },\n  ];\n\n  return (\n    <div>\n      <PageHeader\n        title=\"Security\"\n        subtitle=\"Governance, audit logs, capability management, and incident response\"\n      />\n\n      {!operatorAgentId && (\n        <div className=\"mb-4 px-4 py-3 glass-card text-sm text-warning\">\n          Set an operator agent in Settings to use security features.\n        </div>\n      )}\n\n      {/* Tab Bar */}\n      <div className=\"flex gap-1 mb-6 p-1 glass-card w-fit\">\n        {tabs.map((tab) => (\n          <button\n            key={tab.id}\n            onClick={() => setActiveTab(tab.id)}\n            className={`px-4 py-2 text-sm rounded-input transition-colors ${\n              activeTab === tab.id\n                ? \"bg-accent-blue/15 text-accent-blue font-medium\"\n                : \"text-white/50 hover:text-white/70\"\n            }`}\n          >\n            {tab.label}\n          </button>\n        ))}\n      </div>\n\n      <Panel>\n        {activeTab === \"governance\" && (\n          <GovernancePanel\n            policies={governance.policies}\n            cases={governance.cases}\n            sanctions={governance.sanctions}\n            appeals={governance.appeals}\n            onOpenCase={governance.openCase}\n            onResolveCase={governance.resolveCase}\n            onApplySanction={governance.applySanction}\n            onLiftSanction={governance.liftSanction}\n            onOpenAppeal={governance.openAppeal}\n            onResolveAppeal={governance.resolveAppeal}\n          />\n        )}\n\n        {activeTab === \"audit\" && (\n          <AuditLog\n            entries={audit.entries}\n            loading={audit.loading}\n            onQuery={audit.query}\n          />\n        )}\n\n        {activeTab === \"capabilities\" && (\n          <CapabilityManager\n            tokens={capabilities.tokens}\n            loading={capabilities.loading}\n            onList={capabilities.listTokens}\n            onGrant={capabilities.grant}\n            onRevoke={capabilities.revoke}\n            onRevokeAll={capabilities.revokeAll}\n          />\n        )}\n\n        {activeTab === \"incident\" && <IncidentPanel />}\n\n        {governance.error && (\n          <div className=\"mt-3 text-xs text-danger\">{governance.error}</div>\n        )}\n      </Panel>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAZA;;;;;;;;;;;;;AAgBe,SAAS;IACtB,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,gVAAQ,EAAc;IACxD,MAAM,EAAE,MAAM,EAAE,eAAe,EAAE,GAAG,IAAA,iKAAY;IAEhD,MAAM,aAAa,IAAA,mKAAa;IAChC,MAAM,QAAQ,IAAA,yJAAQ;IACtB,MAAM,eAAe,IAAA,uKAAe;IAEpC,IAAA,iVAAS,EAAC;QACR,IAAI,WAAW,eAAe,iBAAiB;YAC7C,WAAW,OAAO;QACpB;IACF,GAAG;QAAC;QAAQ;KAAgB;IAE5B,MAAM,OAA6C;QACjD;YAAE,IAAI;YAAc,OAAO;QAAa;QACxC;YAAE,IAAI;YAAS,OAAO;QAAY;QAClC;YAAE,IAAI;YAAgB,OAAO;QAAe;QAC5C;YAAE,IAAI;YAAY,OAAO;QAAW;KACrC;IAED,qBACE,6WAAC;;0BACC,6WAAC,6KAAU;gBACT,OAAM;gBACN,UAAS;;;;;;YAGV,CAAC,iCACA,6WAAC;gBAAI,WAAU;0BAAiD;;;;;;0BAMlE,6WAAC;gBAAI,WAAU;0BACZ,KAAK,GAAG,CAAC,CAAC,oBACT,6WAAC;wBAEC,SAAS,IAAM,aAAa,IAAI,EAAE;wBAClC,WAAW,CAAC,kDAAkD,EAC5D,cAAc,IAAI,EAAE,GAChB,mDACA,qCACJ;kCAED,IAAI,KAAK;uBARL,IAAI,EAAE;;;;;;;;;;0BAajB,6WAAC,mKAAK;;oBACH,cAAc,8BACb,6WAAC,yLAAe;wBACd,UAAU,WAAW,QAAQ;wBAC7B,OAAO,WAAW,KAAK;wBACvB,WAAW,WAAW,SAAS;wBAC/B,SAAS,WAAW,OAAO;wBAC3B,YAAY,WAAW,QAAQ;wBAC/B,eAAe,WAAW,WAAW;wBACrC,iBAAiB,WAAW,aAAa;wBACzC,gBAAgB,WAAW,YAAY;wBACvC,cAAc,WAAW,UAAU;wBACnC,iBAAiB,WAAW,aAAa;;;;;;oBAI5C,cAAc,yBACb,6WAAC,2KAAQ;wBACP,SAAS,MAAM,OAAO;wBACtB,SAAS,MAAM,OAAO;wBACtB,SAAS,MAAM,KAAK;;;;;;oBAIvB,cAAc,gCACb,6WAAC,6LAAiB;wBAChB,QAAQ,aAAa,MAAM;wBAC3B,SAAS,aAAa,OAAO;wBAC7B,QAAQ,aAAa,UAAU;wBAC/B,SAAS,aAAa,KAAK;wBAC3B,UAAU,aAAa,MAAM;wBAC7B,aAAa,aAAa,SAAS;;;;;;oBAItC,cAAc,4BAAc,6WAAC,qLAAa;;;;;oBAE1C,WAAW,KAAK,kBACf,6WAAC;wBAAI,WAAU;kCAA4B,WAAW,KAAK;;;;;;;;;;;;;;;;;;AAKrE"}}]
}