(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,23889,e=>{"use strict";var t=e.i(87433),a=e.i(44440),s=e.i(62924);function l({title:e,icon:l,children:n,className:i,noPadding:r}){let c=(0,s.useRouter)(),[o,d]=(0,a.useState)(!1);return(0,t.jsxs)("div",{className:`flex flex-col bg-ctp-mantle border border-ctp-surface0 rounded-window shadow-lg shadow-black/20 overflow-hidden ${i??""}`,children:[(0,t.jsxs)("div",{className:"window-titlebar shrink-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1.5 mr-2",children:[(0,t.jsx)("button",{onClick:()=>c.push("/"),className:"w-3 h-3 rounded-full bg-ctp-red hover:brightness-110 transition-all",title:"Close — go to desktop"}),(0,t.jsx)("button",{onClick:()=>d(!o),className:"w-3 h-3 rounded-full bg-ctp-yellow hover:brightness-110 transition-all",title:o?"Restore":"Minimize"}),(0,t.jsx)("button",{onClick:()=>d(!1),className:"w-3 h-3 rounded-full bg-ctp-green hover:brightness-110 transition-all",title:"Maximize"})]}),l&&(0,t.jsx)("span",{className:"text-ctp-subtext0",children:l}),(0,t.jsx)("span",{className:"text-xs font-mono font-medium text-ctp-subtext1 truncate",children:e})]}),!o&&(0,t.jsx)("div",{className:`flex-1 overflow-auto ${r?"":"p-4"}`,children:n}),o&&(0,t.jsx)("div",{className:"px-4 py-6 text-center",children:(0,t.jsx)("button",{onClick:()=>d(!1),className:"text-xs font-mono text-ctp-overlay0 hover:text-ctp-text transition-colors",children:"Click to restore window"})})]})}e.s(["Window",()=>l])},32372,e=>{"use strict";var t=e.i(87433);function a({message:e,hint:a,className:s=""}){return(0,t.jsxs)("div",{className:`py-8 text-center font-mono ${s}`,children:[(0,t.jsx)("div",{className:"text-sm text-ctp-overlay0",children:e}),a&&(0,t.jsx)("div",{className:"text-xs text-ctp-overlay0/70 mt-1",children:a})]})}e.s(["EmptyState",()=>a])},43332,e=>{"use strict";var t=e.i(87433);let a={primary:"bg-ctp-blue text-ctp-crust font-medium hover:bg-ctp-lavender active:bg-ctp-sapphire",ghost:"bg-ctp-surface0 text-ctp-subtext1 hover:bg-ctp-surface1 hover:text-ctp-text active:bg-ctp-surface2",danger:"bg-ctp-red/15 text-ctp-red hover:bg-ctp-red/25 active:bg-ctp-red/35"};function s({variant:e="primary",children:s,className:l="",disabled:n,...i}){return(0,t.jsx)("button",{className:`px-4 py-2 rounded-input text-sm transition-colors duration-150 cursor-pointer disabled:opacity-40 disabled:cursor-not-allowed ${a[e]} ${l}`,disabled:n,...i,children:s})}e.s(["Button",()=>s])},4457,59913,e=>{"use strict";var t=e.i(87433);function a({children:e,className:a=""}){return(0,t.jsx)("div",{className:`os-panel p-4 ${a}`,children:e})}e.s(["Panel",()=>a],4457);let s={default:"bg-ctp-surface1 text-ctp-subtext1",success:"bg-ctp-green/15 text-ctp-green",warning:"bg-ctp-yellow/15 text-ctp-yellow",danger:"bg-ctp-red/15 text-ctp-red",info:"bg-ctp-blue/15 text-ctp-blue"};function l({children:e,variant:a="default",className:l=""}){return(0,t.jsx)("span",{className:`inline-flex items-center px-2.5 py-0.5 text-xs font-mono font-medium rounded-pill ${s[a]} ${l}`,children:e})}e.s(["Tag",()=>l],59913)},51339,e=>{"use strict";var t=e.i(87433);function a({label:e,className:a="",id:s,...l}){let n=s||e?.toLowerCase().replace(/\s+/g,"-");return(0,t.jsxs)("div",{className:"flex flex-col gap-1.5",children:[e&&(0,t.jsx)("label",{htmlFor:n,className:"text-xs text-ctp-subtext0 font-medium",children:e}),(0,t.jsx)("input",{id:n,className:`bg-ctp-surface0 border border-ctp-surface1 rounded-input px-3 py-2 text-sm text-ctp-text placeholder:text-ctp-overlay0 focus:outline-none focus:border-ctp-blue/50 focus:ring-1 focus:ring-ctp-blue/20 transition-colors ${a}`,...l})]})}e.s(["Input",()=>a])},29273,e=>{"use strict";var t=e.i(87433),a=e.i(44440),s=e.i(23889),l=e.i(4457),n=e.i(59913),i=e.i(51339),r=e.i(43332),c=e.i(32372);function o(e){if(!e||"object"!=typeof e)return"No evidence";let t=Object.keys(e);return t.length?`Evidence: ${t.slice(0,3).join(", ")}${t.length>3?"...":""}`:"No evidence"}function d({policies:e,cases:s,sanctions:l,appeals:d,onOpenCase:p,onResolveCase:u,onApplySanction:x,onLiftSanction:m,onOpenAppeal:h,onResolveAppeal:v}){let[b,g]=(0,a.useState)(""),[y,f]=(0,a.useState)(""),[j,N]=(0,a.useState)(""),[w,S]=(0,a.useState)(""),[k,C]=(0,a.useState)("warning"),[I,_]=(0,a.useState)(""),[A,D]=(0,a.useState)(""),[E,$]=(0,a.useState)(""),[B,L]=(0,a.useState)(""),[R,T]=(0,a.useState)(""),[P,W]=(0,a.useState)(""),[G,O]=(0,a.useState)(""),[q,F]=(0,a.useState)(""),[M,z]=(0,a.useState)(""),Q=async e=>{e.preventDefault(),b.trim()&&(await p(b.trim(),y.trim()||void 0,j.trim()||void 0),g(""),f(""),N(""))},K=async e=>{e.preventDefault(),w.trim()&&(await x(w.trim(),k),S(""))},U=async e=>{e.preventDefault(),I.trim()&&(await u(I.trim(),A.trim()||void 0,E.trim()||void 0),_(""),D(""),$(""))},V=async e=>{e.preventDefault(),B.trim()&&(await m(B.trim()),L(""))},H=async e=>{e.preventDefault(),R.trim()&&(await h(R.trim(),P.trim()||void 0),T(""),W(""))},J=async e=>{e.preventDefault(),G.trim()&&(await v(G.trim(),q.trim()||void 0,M.trim()||void 0),O(""),F(""),z(""))};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-xs font-mono font-semibold text-ctp-subtext0 uppercase tracking-wider mb-3",children:"Policies"}),0===e.length?(0,t.jsx)(c.EmptyState,{message:"No policies"}):(0,t.jsx)("div",{className:"space-y-2",children:e.map(e=>(0,t.jsxs)("div",{className:"os-panel px-3 py-2 flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm font-medium text-ctp-text",children:e.name}),(0,t.jsx)(n.Tag,{variant:"active"===e.status?"success":"default",className:"ml-2",children:e.status||"active"})]}),(0,t.jsx)("span",{className:"text-2xs text-ctp-overlay0",children:e.id})]},e.id))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-xs font-mono font-semibold text-ctp-subtext0 uppercase tracking-wider mb-3",children:"Moderation Cases"}),0===s.length?(0,t.jsx)(c.EmptyState,{message:"No cases"}):(0,t.jsx)("div",{className:"space-y-2",children:s.map(e=>(0,t.jsxs)("div",{className:"os-panel px-3 py-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-ctp-text",children:e.id}),(0,t.jsx)(n.Tag,{variant:"open"===e.status?"warning":"default",children:e.status})]}),(0,t.jsxs)("div",{className:"text-2xs text-ctp-overlay0 mt-1",children:[e.reason||"No reason"," | ",o(e.evidence)]})]},e.id))}),(0,t.jsxs)("form",{onSubmit:Q,className:"mt-3 flex gap-2 items-end",children:[(0,t.jsx)(i.Input,{label:"Subject Agent",value:b,onChange:e=>g(e.target.value),placeholder:"agent-id"}),(0,t.jsx)(i.Input,{label:"Policy ID",value:y,onChange:e=>f(e.target.value),placeholder:"optional"}),(0,t.jsx)(i.Input,{label:"Reason",value:j,onChange:e=>N(e.target.value),placeholder:"optional"}),(0,t.jsx)(r.Button,{type:"submit",disabled:!b.trim(),children:"Open Case"})]}),(0,t.jsxs)("form",{onSubmit:U,className:"mt-2 flex gap-2 items-end",children:[(0,t.jsx)(i.Input,{label:"Case ID",value:I,onChange:e=>_(e.target.value),placeholder:"case-id"}),(0,t.jsx)(i.Input,{label:"Status",value:A,onChange:e=>D(e.target.value),placeholder:"resolved"}),(0,t.jsx)(i.Input,{label:"Notes",value:E,onChange:e=>$(e.target.value),placeholder:"optional"}),(0,t.jsx)(r.Button,{type:"submit",variant:"ghost",disabled:!I.trim(),children:"Resolve"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-xs font-mono font-semibold text-ctp-subtext0 uppercase tracking-wider mb-3",children:"Sanctions"}),0===l.length?(0,t.jsx)(c.EmptyState,{message:"No sanctions"}):(0,t.jsx)("div",{className:"space-y-2",children:l.map(e=>(0,t.jsxs)("div",{className:"os-panel px-3 py-2 flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm text-ctp-text",children:e.type}),(0,t.jsx)("span",{className:"text-2xs text-ctp-overlay0 ml-2",children:e.subject_agent_id||"—"})]}),(0,t.jsx)("span",{className:"text-2xs text-ctp-overlay0",children:e.id})]},e.id))}),(0,t.jsxs)("form",{onSubmit:K,className:"mt-3 flex gap-2 items-end",children:[(0,t.jsx)(i.Input,{label:"Subject Agent",value:w,onChange:e=>S(e.target.value),placeholder:"agent-id"}),(0,t.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,t.jsx)("label",{className:"text-xs text-ctp-subtext0 font-medium",children:"Type"}),(0,t.jsxs)("select",{value:k,onChange:e=>C(e.target.value),className:"bg-ctp-surface0 border border-ctp-surface1 rounded-input px-3 py-2 text-sm text-ctp-text",children:[(0,t.jsx)("option",{value:"warning",className:"bg-ctp-mantle",children:"Warning"}),(0,t.jsx)("option",{value:"quarantine",className:"bg-ctp-mantle",children:"Quarantine"}),(0,t.jsx)("option",{value:"suspension",className:"bg-ctp-mantle",children:"Suspension"}),(0,t.jsx)("option",{value:"ban",className:"bg-ctp-mantle",children:"Ban"})]})]}),(0,t.jsx)(r.Button,{type:"submit",disabled:!w.trim(),children:"Apply"})]}),(0,t.jsxs)("form",{onSubmit:V,className:"mt-2 flex gap-2 items-end",children:[(0,t.jsx)(i.Input,{label:"Sanction ID",value:B,onChange:e=>L(e.target.value),placeholder:"sanction-id"}),(0,t.jsx)(r.Button,{type:"submit",variant:"ghost",disabled:!B.trim(),children:"Lift"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-xs font-mono font-semibold text-ctp-subtext0 uppercase tracking-wider mb-3",children:"Appeals"}),0===d.length?(0,t.jsx)(c.EmptyState,{message:"No appeals"}):(0,t.jsx)("div",{className:"space-y-2",children:d.map(e=>(0,t.jsxs)("div",{className:"os-panel px-3 py-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-sm text-ctp-text",children:e.id}),(0,t.jsx)(n.Tag,{variant:"open"===e.status?"warning":"default",children:e.status})]}),(0,t.jsxs)("div",{className:"text-2xs text-ctp-overlay0 mt-1",children:[e.resolution||"No resolution"," | ",o(e.evidence)]})]},e.id))}),(0,t.jsxs)("form",{onSubmit:H,className:"mt-3 flex gap-2 items-end",children:[(0,t.jsx)(i.Input,{label:"Case ID",value:R,onChange:e=>T(e.target.value),placeholder:"case-id"}),(0,t.jsx)(i.Input,{label:"Reason",value:P,onChange:e=>W(e.target.value),placeholder:"optional"}),(0,t.jsx)(r.Button,{type:"submit",disabled:!R.trim(),children:"Open Appeal"})]}),(0,t.jsxs)("form",{onSubmit:J,className:"mt-2 flex gap-2 items-end",children:[(0,t.jsx)(i.Input,{label:"Appeal ID",value:G,onChange:e=>O(e.target.value),placeholder:"appeal-id"}),(0,t.jsx)(i.Input,{label:"Status",value:q,onChange:e=>F(e.target.value),placeholder:"resolved"}),(0,t.jsx)(i.Input,{label:"Notes",value:M,onChange:e=>z(e.target.value),placeholder:"optional"}),(0,t.jsx)(r.Button,{type:"submit",variant:"ghost",disabled:!G.trim(),children:"Resolve"})]})]})]})}function p({entries:e,loading:s,onQuery:l}){let[n,o]=(0,a.useState)(""),[d,p]=(0,a.useState)(""),[u,x]=(0,a.useState)("50");return(0,t.jsxs)("div",{children:[(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),l({action:n.trim()||void 0,actorId:d.trim()||void 0,limit:Number(u)||50})},className:"flex gap-2 items-end mb-4",children:[(0,t.jsx)(i.Input,{label:"Action",value:n,onChange:e=>o(e.target.value),placeholder:"filter by action"}),(0,t.jsx)(i.Input,{label:"Actor ID",value:d,onChange:e=>p(e.target.value),placeholder:"filter by actor"}),(0,t.jsx)("div",{className:"w-20",children:(0,t.jsx)(i.Input,{label:"Limit",type:"number",value:u,onChange:e=>x(e.target.value)})}),(0,t.jsx)(r.Button,{type:"submit",disabled:s,children:s?"Loading...":"Query"})]}),0===e.length?(0,t.jsx)(c.EmptyState,{message:"No audit entries"}):(0,t.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:e.map((e,a)=>(0,t.jsxs)("div",{className:"os-panel px-3 py-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-ctp-text",children:e.action}),(0,t.jsx)("span",{className:"text-2xs text-ctp-overlay0",children:new Date(e.created_at).toLocaleString()})]}),(0,t.jsxs)("div",{className:"text-2xs text-ctp-overlay0 mt-0.5",children:["Actor: ",e.actor_id||"—"," | Resource: ",e.resource_type||"—"," | Outcome: ",e.outcome]})]},e.id||a))})]})}function u({tokens:e,loading:s,onList:l,onGrant:n,onRevoke:o,onRevokeAll:d}){let[p,u]=(0,a.useState)(""),[x,m]=(0,a.useState)(""),[h,v]=(0,a.useState)(""),[b,g]=(0,a.useState)(""),[y,f]=(0,a.useState)(""),j=async e=>{if(e.preventDefault(),!p.trim()||!x.trim())return;let t=x.split(/[\n,]/).map(e=>e.trim()).filter(Boolean),a=Number(b);await n(p.trim(),t,h.trim()||void 0,a>0?a:void 0),m(""),v(""),g("")},N=async e=>{e.preventDefault(),y.trim()&&(await o(y.trim()),f(""))},w=async()=>{p.trim()&&await d(p.trim())};return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex gap-2 items-end mb-4",children:[(0,t.jsx)(i.Input,{label:"Agent ID",value:p,onChange:e=>u(e.target.value),placeholder:"agent-id"}),(0,t.jsx)(r.Button,{onClick:()=>l(p.trim()||void 0),disabled:s,children:s?"Loading...":"List Tokens"}),(0,t.jsx)(r.Button,{variant:"danger",onClick:w,disabled:!p.trim(),children:"Revoke All"})]}),0===e.length?(0,t.jsx)(c.EmptyState,{message:"No capability tokens"}):(0,t.jsx)("div",{className:"space-y-2 mb-6 max-h-64 overflow-y-auto",children:e.map(e=>(0,t.jsxs)("div",{className:"os-panel px-3 py-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-ctp-text",children:e.id}),(0,t.jsx)(r.Button,{variant:"ghost",onClick:()=>o(e.id),className:"text-xs",children:"Revoke"})]}),(0,t.jsxs)("div",{className:"text-2xs text-ctp-overlay0 mt-0.5",children:["Agent: ",e.agentId," | Expires: ",e.expiresAt?new Date(e.expiresAt).toLocaleString():"—"]}),(0,t.jsx)("div",{className:"text-2xs text-ctp-overlay0 mt-0.5",children:Array.isArray(e.permissions)?e.permissions.map(e=>`${e.category}.${e.actions?.join("|")||"*"}${e.resource?`:${e.resource}`:""}`).join(", "):"—"})]},e.id))}),(0,t.jsxs)("div",{className:"border-t border-ctp-surface0 pt-4 mt-4",children:[(0,t.jsx)("h4",{className:"text-xs font-mono text-ctp-subtext0 uppercase mb-3",children:"Grant Token"}),(0,t.jsxs)("form",{onSubmit:j,className:"space-y-2",children:[(0,t.jsx)(i.Input,{label:"Permissions (comma-separated)",value:x,onChange:e=>m(e.target.value),placeholder:"memory.read, llm.execute"}),(0,t.jsxs)("div",{className:"flex gap-2 items-end",children:[(0,t.jsx)(i.Input,{label:"Purpose",value:h,onChange:e=>v(e.target.value),placeholder:"optional"}),(0,t.jsx)("div",{className:"w-40",children:(0,t.jsx)(i.Input,{label:"Duration (ms)",type:"number",value:b,onChange:e=>g(e.target.value),placeholder:"optional"})}),(0,t.jsx)(r.Button,{type:"submit",disabled:!p.trim()||!x.trim(),children:"Grant"})]})]})]}),(0,t.jsxs)("div",{className:"border-t border-ctp-surface0 pt-4 mt-4",children:[(0,t.jsx)("h4",{className:"text-xs font-mono text-ctp-subtext0 uppercase mb-3",children:"Revoke by ID"}),(0,t.jsxs)("form",{onSubmit:N,className:"flex gap-2 items-end",children:[(0,t.jsx)(i.Input,{label:"Token ID",value:y,onChange:e=>f(e.target.value),placeholder:"token-id"}),(0,t.jsx)(r.Button,{type:"submit",variant:"danger",disabled:!y.trim(),children:"Revoke"})]})]})]})}var x=e.i(24876);function m(){let{sendAgentTask:e,operatorAgentId:s}=(0,x.useWebSocket)(),[l,n]=(0,a.useState)("Global Lockdown"),[c,o]=(0,a.useState)(null),[d,p]=(0,a.useState)(!1),u=async t=>{if(!s)throw Error("Set operator agent first");return e(s,t)},m=async e=>{let t=await u({type:"policy_list",limit:100});return t?.policies?.find(t=>t.name===e)},h=async e=>{let t=await m(e);if(t)return t;let a=await u({type:"policy_create",name:e,description:"Global incident lockdown policy",rules:{rules:[{type:"deny",action:"tool.invoked",resourceType:"tool",reason:"Incident lockdown active",sanction:{type:"quarantine"}}]}});return a?.policy},v=async()=>{p(!0),o(null);try{let e=await h(l.trim()||"Global Lockdown");e?.id&&(await u({type:"policy_set_status",policyId:e.id,status:"active"}),o(`Lockdown enabled (${e.id})`))}catch(e){o(`Error: ${e instanceof Error?e.message:"Failed"}`)}finally{p(!1)}},b=async()=>{p(!0),o(null);try{let e=await m(l.trim()||"Global Lockdown");if(!e?.id)return void o("No policy found");await u({type:"policy_set_status",policyId:e.id,status:"inactive"}),o(`Lockdown disabled (${e.id})`)}catch(e){o(`Error: ${e instanceof Error?e.message:"Failed"}`)}finally{p(!1)}};return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex gap-2 items-end mb-4",children:[(0,t.jsx)(i.Input,{label:"Policy Name",value:l,onChange:e=>n(e.target.value),placeholder:"Global Lockdown"}),(0,t.jsx)(r.Button,{onClick:v,disabled:d,children:d?"Working...":"Enable Lockdown"}),(0,t.jsx)(r.Button,{variant:"ghost",onClick:b,disabled:d,children:"Disable Lockdown"})]}),c&&(0,t.jsx)("div",{className:`text-xs font-mono ${c.startsWith("Error")?"text-ctp-red":"text-ctp-green"}`,children:c})]})}function h(){let[e,n]=(0,a.useState)("audit"),{status:i,operatorAgentId:r}=(0,x.useWebSocket)(),c=function(){let{sendAgentTask:e,operatorAgentId:t}=(0,x.useWebSocket)(),[s,l]=(0,a.useState)({policies:[],cases:[],sanctions:[],appeals:[]}),[n,i]=(0,a.useState)(!1),[r,c]=(0,a.useState)(null),o=(0,a.useCallback)(async a=>{if(!t)throw Error("Set operator agent first");return e(t,a)},[e,t]),d=(0,a.useCallback)(async()=>{if(t){i(!0),c(null);try{let[e,t,a,s]=await Promise.all([o({type:"policy_list",limit:50}),o({type:"moderation_case_list",limit:50}),o({type:"sanction_list",limit:50}),o({type:"appeal_list",limit:50})]);l({policies:e?.policies??[],cases:t?.cases??[],sanctions:a?.sanctions??[],appeals:s?.appeals??[]})}catch(e){c(e instanceof Error?e.message:"Failed to fetch")}finally{i(!1)}}},[o,t]),p=(0,a.useCallback)(async(e,t,a)=>{await o({type:"moderation_case_open",subjectAgentId:e,...t&&{policyId:t},...a&&{reason:a}}),await d()},[o,d]),u=(0,a.useCallback)(async(e,t,a)=>{await o({type:"moderation_case_resolve",caseId:e,...t&&{status:t},...a&&{resolution:a}}),await d()},[o,d]),m=(0,a.useCallback)(async(e,t)=>{await o({type:"sanction_apply",subjectAgentId:e,sanctionType:t}),await d()},[o,d]),h=(0,a.useCallback)(async e=>{await o({type:"sanction_lift",sanctionId:e}),await d()},[o,d]),v=(0,a.useCallback)(async(e,t)=>{await o({type:"appeal_open",caseId:e,...t&&{reason:t}}),await d()},[o,d]),b=(0,a.useCallback)(async(e,t,a)=>{await o({type:"appeal_resolve",appealId:e,...t&&{status:t},...a&&{resolution:a}}),await d()},[o,d]);return{...s,loading:n,error:r,refresh:d,openCase:p,resolveCase:u,applySanction:m,liftSanction:h,openAppeal:v,resolveAppeal:b}}(),o=function(){let{sendAgentTask:e,operatorAgentId:t}=(0,x.useWebSocket)(),[s,l]=(0,a.useState)([]),[n,i]=(0,a.useState)(!1),[r,c]=(0,a.useState)(null);return{entries:s,loading:n,error:r,query:(0,a.useCallback)(async a=>{if(!t)return void c("Set operator agent first");i(!0),c(null);try{let s=await e(t,{type:"audit_query",...a?.action&&{action:a.action},...a?.actorId&&{actorId:a.actorId},limit:a?.limit||50});l(s?.entries??[])}catch(e){c(e instanceof Error?e.message:"Audit query failed")}finally{i(!1)}},[e,t])}}(),h=function(){let{sendAgentTask:e,operatorAgentId:t}=(0,x.useWebSocket)(),[s,l]=(0,a.useState)([]),[n,i]=(0,a.useState)(!1),[r,c]=(0,a.useState)(null),o=(0,a.useCallback)(async a=>{if(!t)throw Error("Set operator agent first");return e(t,a)},[e,t]),d=(0,a.useCallback)(async e=>{i(!0),c(null);try{let a=await o({type:"capability_list",agentId:e||t});l(a?.tokens??[])}catch(e){c(e instanceof Error?e.message:"Failed to list tokens")}finally{i(!1)}},[o,t]),p=(0,a.useCallback)(async(e,t,a,s)=>{await o({type:"capability_grant",agentId:e,permissions:t,...a&&{purpose:a},...s&&{durationMs:s}}),await d(e)},[o,d]),u=(0,a.useCallback)(async e=>{await o({type:"capability_revoke",tokenId:e}),await d()},[o,d]),m=(0,a.useCallback)(async e=>{await o({type:"capability_revoke_all",agentId:e}),await d(e)},[o,d]);return{tokens:s,loading:n,error:r,listTokens:d,grant:p,revoke:u,revokeAll:m}}();return(0,a.useEffect)(()=>{"connected"===i&&r&&c.refresh()},[i,r]),(0,t.jsxs)(s.Window,{title:"Security Center",icon:(0,t.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:(0,t.jsx)("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})}),className:"h-full",children:[!r&&(0,t.jsx)("div",{className:"mb-4 px-3 py-2 bg-ctp-yellow/10 border border-ctp-yellow/20 rounded-panel text-xs text-ctp-yellow font-mono",children:"Set an operator agent in Preferences to use security features."}),(0,t.jsx)("div",{className:"flex gap-1 mb-4 p-1 bg-ctp-crust rounded-panel w-fit",children:[{id:"audit",label:"Audit Log"},{id:"governance",label:"Governance",preview:!0},{id:"capabilities",label:"Capabilities",preview:!0},{id:"incident",label:"Incident",preview:!0}].map(a=>(0,t.jsxs)("button",{onClick:()=>n(a.id),className:`px-3 py-1.5 text-xs font-mono rounded-input transition-colors ${e===a.id?"bg-ctp-blue/15 text-ctp-blue font-medium":"text-ctp-overlay0 hover:text-ctp-subtext1"}`,children:[a.label,a.preview&&(0,t.jsx)("span",{className:"ml-1.5 text-2xs px-1 py-0.5 rounded bg-ctp-surface1 text-ctp-overlay0",children:"Preview"})]},a.id))}),(0,t.jsxs)(l.Panel,{children:["governance"===e&&(0,t.jsx)(d,{policies:c.policies,cases:c.cases,sanctions:c.sanctions,appeals:c.appeals,onOpenCase:c.openCase,onResolveCase:c.resolveCase,onApplySanction:c.applySanction,onLiftSanction:c.liftSanction,onOpenAppeal:c.openAppeal,onResolveAppeal:c.resolveAppeal}),"audit"===e&&(0,t.jsx)(p,{entries:o.entries,loading:o.loading,onQuery:o.query}),"capabilities"===e&&(0,t.jsx)(u,{tokens:h.tokens,loading:h.loading,onList:h.listTokens,onGrant:h.grant,onRevoke:h.revoke,onRevokeAll:h.revokeAll}),"incident"===e&&(0,t.jsx)(m,{}),c.error&&(0,t.jsx)("div",{className:"mt-3 text-xs text-ctp-red font-mono",children:c.error})]})]})}e.s(["default",()=>h],29273)}]);