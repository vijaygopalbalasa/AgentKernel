(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,45694,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"warnOnce",{enumerable:!0,get:function(){return n}});let n=e=>{}},74206,e=>{"use strict";let t=0;function r(e="req"){return t+=1,`${e}-${Date.now()}-${t}`}function n(e){return{type:"auth",id:r("auth"),payload:{token:e}}}function s(){return{type:"agent_status",id:r("agents")}}function a(e){return{type:"subscribe",id:r("sub"),payload:{channels:e}}}function o(e,t){return{type:"chat",id:r("chat"),payload:{messages:e,...t?.model&&{model:t.model},...t?.maxTokens&&{maxTokens:t.maxTokens},...t?.temperature!==void 0&&{temperature:t.temperature},...t?.stream&&{stream:!0},...t?.systemPrompt&&{systemPrompt:t.systemPrompt}}}}function c(e,t){return{type:"agent_task",id:r("task"),payload:{agentId:e,task:t}}}function i(e){return{type:"agent_spawn",id:r("spawn"),payload:{manifest:e}}}function l(e,t=!1){return{type:"agent_terminate",id:r("term"),payload:{agentId:e,force:t}}}e.s(["agentSpawnMessage",()=>i,"agentStatusMessage",()=>s,"agentTaskMessage",()=>c,"agentTerminateMessage",()=>l,"authMessage",()=>n,"chatMessage",()=>o,"subscribeMessage",()=>a])},44814,e=>{"use strict";let t=window.location.hostname;function r(e,r){return`ws://${e||t}:${r||18800}`}function n(e,r){return`http://${e||t}:${r||18801}/health`}function s(e,r){return`http://${e||t}:${r||18801}/metrics`}e.s(["MAX_EVENTS",0,100,"RECONNECT_BASE_MS",0,1e3,"RECONNECT_MAX_MS",0,3e4,"REQUEST_TIMEOUT_MS",0,1e4,"getHealthUrl",()=>n,"getMetricsUrl",()=>s,"getWsUrl",()=>r])},24876,58447,e=>{"use strict";var t=e.i(44440),r=e.i(87433),n=e.i(74206),s=e.i(44814);let a=(0,t.createContext)(null);function o({children:e}){let[o,c]=(0,t.useState)("disconnected"),[i,l]=(0,t.useState)([]),[u,d]=(0,t.useState)(null),p=(0,t.useRef)(null),f=(0,t.useRef)(new Map),h=(0,t.useRef)(new Map),m=(0,t.useRef)(0),x=(0,t.useRef)(null),g=(0,t.useRef)(""),y=(0,t.useRef)("disconnected"),b=(0,t.useRef)(!1),j=(0,t.useRef)(()=>{});(0,t.useEffect)(()=>{let e=localStorage.getItem("gatewayAuthToken")||"",t=localStorage.getItem("operatorAgentId")||null;g.current=e,d(t)},[]);let v=(0,t.useCallback)(e=>{l(t=>[e,...t].slice(0,s.MAX_EVENTS))},[]),N=(0,t.useRef)(()=>{});N.current=e=>{y.current="connected",c("connected"),m.current=0,e.send(JSON.stringify((0,n.agentStatusMessage)())),e.send(JSON.stringify((0,n.subscribeMessage)(["agent.lifecycle","system","audit","*"]))),v({type:"connection",summary:"Connected to gateway",timestamp:new Date().toLocaleTimeString()})};let w=(0,t.useRef)(()=>{});w.current=e=>{let t;try{t=JSON.parse(e.data)}catch{return}if(t.id&&f.current.has(t.id)){let e=f.current.get(t.id);f.current.delete(t.id),clearTimeout(e.timeoutId),e.resolve(t);return}if("chat_stream"===t.type&&t.id){let e=h.current.get(t.id);if(e){let r=t.payload?.delta||"";e.accumulated+=r,e.onDelta(r)}return}if("chat_stream_end"===t.type&&t.id){let e=h.current.get(t.id);e&&(h.current.delete(t.id),e.resolve({content:e.accumulated,model:t.payload?.model,usage:t.payload?.usage}));return}if("auth_success"===t.type)return void N.current(p.current);if("auth_required"===t.type){y.current="auth_required",c("auth_required"),g.current&&p.current?.send(JSON.stringify((0,n.authMessage)(g.current)));return}if("auth_failed"===t.type){y.current="auth_failed",c("auth_failed"),v({type:"auth",summary:t.payload?.message||"Authentication failed",timestamp:new Date().toLocaleTimeString()});return}if("event"===t.type&&t.payload){let e=t.payload;v({type:e.type||"event",summary:e.channel?`${e.channel} ${e.data?JSON.stringify(e.data):""}`:"",timestamp:new Date(e.timestamp||Date.now()).toLocaleTimeString(),channel:e.channel});return}"error"===t.type&&v({type:"error",summary:t.payload?.message||"Gateway error",timestamp:new Date().toLocaleTimeString()})};let k=(0,t.useCallback)(()=>{x.current&&(clearTimeout(x.current),x.current=null),p.current&&(b.current=!0,p.current.close()),y.current="connecting",c("connecting");let e=new WebSocket((0,s.getWsUrl)());p.current=e,e.addEventListener("open",()=>{g.current?e.send(JSON.stringify((0,n.authMessage)(g.current))):N.current(e)}),e.addEventListener("close",()=>{if(p.current!==e)return;if(y.current="disconnected",c("disconnected"),b.current){b.current=!1;return}let t=Math.min(s.RECONNECT_BASE_MS*Math.pow(2,m.current),s.RECONNECT_MAX_MS);m.current+=1,x.current=setTimeout(()=>j.current(),t)}),e.addEventListener("message",e=>w.current(e)),e.addEventListener("error",()=>{})},[]);j.current=k,(0,t.useEffect)(()=>(k(),()=>{x.current&&clearTimeout(x.current),p.current&&(b.current=!0,p.current.close())}),[]);let S=(0,t.useCallback)(e=>p.current&&p.current.readyState===WebSocket.OPEN?new Promise((t,r)=>{let n=setTimeout(()=>{f.current.delete(e.id),r(Error("Request timeout"))},s.REQUEST_TIMEOUT_MS);f.current.set(e.id,{resolve:t,reject:r,timeoutId:n}),p.current.send(JSON.stringify(e))}):Promise.reject(Error("Not connected")),[]),E=(0,t.useCallback)(async(e,t)=>{let r=await S((0,n.agentTaskMessage)(e,t));if("agent_task_result"===r.type){if(r.payload?.status==="ok")return r.payload.result;throw Error(r.payload?.error||"Task failed")}if("error"===r.type)throw Error(r.payload?.message||"Gateway error");throw Error("Unexpected response")},[S]),C=(0,t.useCallback)((e,t,r)=>{if(!p.current||p.current.readyState!==WebSocket.OPEN)return Promise.reject(Error("Not connected"));let s=(0,n.chatMessage)(e,{...r,stream:!0});return new Promise((e,r)=>{h.current.set(s.id,{onDelta:t,accumulated:"",resolve:e,reject:r});let n=setTimeout(()=>{if(h.current.has(s.id)){let e=h.current.get(s.id);h.current.delete(s.id),e.accumulated?e.resolve({content:e.accumulated}):e.reject(Error("Stream timeout"))}},6e4);p.current.send(JSON.stringify(s));let a=h.current.get(s.id);a&&(a.resolve=t=>{clearTimeout(n),e(t)},a.reject=e=>{clearTimeout(n),r(e)})})},[]),T=(0,t.useCallback)(e=>{g.current=e,localStorage.setItem("gatewayAuthToken",e),m.current=0,k()},[k]),_=(0,t.useCallback)(e=>{d(e),e?localStorage.setItem("operatorAgentId",e):localStorage.removeItem("operatorAgentId")},[]);return(0,r.jsx)(a.Provider,{value:{status:o,authenticate:T,sendRequest:S,sendAgentTask:(e,t)=>E(e,t),sendStreamingChat:C,events:i,operatorAgentId:u,setOperatorAgentId:_},children:e})}function c(){let e=(0,t.useContext)(a);if(!e)throw Error("useWebSocket must be used within a WebSocketProvider");return e}e.s(["WebSocketContext",0,a,"WebSocketProvider",()=>o],58447),e.s(["useWebSocket",()=>c],24876)},62924,(e,t,r)=>{t.exports=e.r(37109)},633,e=>{"use strict";var t=e.i(44440),r=e.i(24876),n=e.i(74206);function s(){let{status:e,sendRequest:s}=(0,r.useWebSocket)(),[a,o]=(0,t.useState)([]),[c,i]=(0,t.useState)(!0),[l,u]=(0,t.useState)(null),d=(0,t.useCallback)(async()=>{if("connected"===e)try{i(!0);let e=await s((0,n.agentStatusMessage)());"agent_list"===e.type&&e.payload&&(o(e.payload.agents||[]),u(null))}catch(e){u(e instanceof Error?e.message:"Failed to fetch agents")}finally{i(!1)}},[e,s]);(0,t.useEffect)(()=>{if("connected"===e){d();let e=setInterval(d,1e4);return()=>clearInterval(e)}},[e,d]);let p=(0,t.useCallback)(async e=>{let t=await s((0,n.agentSpawnMessage)(e));if("error"===t.type)throw Error(t.payload?.message||"Failed to spawn agent");return await d(),t},[s,d]),f=(0,t.useCallback)(async(e,t=!1)=>{let r=await s((0,n.agentTerminateMessage)(e,t));if("error"===r.type)throw Error(r.payload?.message||"Failed to terminate agent");return await d(),r},[s,d]);return{agents:a,loading:c,error:l,refresh:d,spawn:p,terminate:f}}e.s(["useAgents",()=>s])},22173,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={assign:function(){return i},searchParamsToUrlQuery:function(){return a},urlQueryToSearchParams:function(){return c}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});function a(e){let t={};for(let[r,n]of e.entries()){let e=t[r];void 0===e?t[r]=n:Array.isArray(e)?e.push(n):t[r]=[e,n]}return t}function o(e){return"string"==typeof e?e:("number"!=typeof e||isNaN(e))&&"boolean"!=typeof e?"":String(e)}function c(e){let t=new URLSearchParams;for(let[r,n]of Object.entries(e))if(Array.isArray(n))for(let e of n)t.append(r,o(e));else t.set(r,o(n));return t}function i(e,...t){for(let r of t){for(let t of r.keys())e.delete(t);for(let[t,n]of r.entries())e.append(t,n)}return e}},48077,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={formatUrl:function(){return c},formatWithValidation:function(){return l},urlObjectKeys:function(){return i}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});let a=e.r(44066)._(e.r(22173)),o=/https?|ftp|gopher|file/;function c(e){let{auth:t,hostname:r}=e,n=e.protocol||"",s=e.pathname||"",c=e.hash||"",i=e.query||"",l=!1;t=t?encodeURIComponent(t).replace(/%3A/i,":")+"@":"",e.host?l=t+e.host:r&&(l=t+(~r.indexOf(":")?`[${r}]`:r),e.port&&(l+=":"+e.port)),i&&"object"==typeof i&&(i=String(a.urlQueryToSearchParams(i)));let u=e.search||i&&`?${i}`||"";return n&&!n.endsWith(":")&&(n+=":"),e.slashes||(!n||o.test(n))&&!1!==l?(l="//"+(l||""),s&&"/"!==s[0]&&(s="/"+s)):l||(l=""),c&&"#"!==c[0]&&(c="#"+c),u&&"?"!==u[0]&&(u="?"+u),s=s.replace(/[?#]/g,encodeURIComponent),u=u.replace("#","%23"),`${n}${l}${s}${u}${c}`}let i=["auth","hash","host","hostname","href","path","pathname","port","protocol","query","search","slashes"];function l(e){return c(e)}},36770,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"useMergedRef",{enumerable:!0,get:function(){return s}});let n=e.r(44440);function s(e,t){let r=(0,n.useRef)(null),s=(0,n.useRef)(null);return(0,n.useCallback)(n=>{if(null===n){let e=r.current;e&&(r.current=null,e());let t=s.current;t&&(s.current=null,t())}else e&&(r.current=a(e,n)),t&&(s.current=a(t,n))},[e,t])}function a(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let r=e(t);return"function"==typeof r?r:()=>e(null)}}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},98334,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={DecodeError:function(){return g},MiddlewareNotFoundError:function(){return v},MissingStaticPage:function(){return j},NormalizeError:function(){return y},PageNotFoundError:function(){return b},SP:function(){return m},ST:function(){return x},WEB_VITALS:function(){return a},execOnce:function(){return o},getDisplayName:function(){return d},getLocationOrigin:function(){return l},getURL:function(){return u},isAbsoluteUrl:function(){return i},isResSent:function(){return p},loadGetInitialProps:function(){return h},normalizeRepeatedSlashes:function(){return f},stringifyError:function(){return N}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});let a=["CLS","FCP","FID","INP","LCP","TTFB"];function o(e){let t,r=!1;return(...n)=>(r||(r=!0,t=e(...n)),t)}let c=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,i=e=>c.test(e);function l(){let{protocol:e,hostname:t,port:r}=window.location;return`${e}//${t}${r?":"+r:""}`}function u(){let{href:e}=window.location,t=l();return e.substring(t.length)}function d(e){return"string"==typeof e?e:e.displayName||e.name||"Unknown"}function p(e){return e.finished||e.headersSent}function f(e){let t=e.split("?");return t[0].replace(/\\/g,"/").replace(/\/\/+/g,"/")+(t[1]?`?${t.slice(1).join("?")}`:"")}async function h(e,t){let r=t.res||t.ctx&&t.ctx.res;if(!e.getInitialProps)return t.ctx&&t.Component?{pageProps:await h(t.Component,t.ctx)}:{};let n=await e.getInitialProps(t);if(r&&p(r))return n;if(!n)throw Object.defineProperty(Error(`"${d(e)}.getInitialProps()" should resolve to an object. But found "${n}" instead.`),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return n}let m="u">typeof performance,x=m&&["mark","measure","getEntriesByName"].every(e=>"function"==typeof performance[e]);class g extends Error{}class y extends Error{}class b extends Error{constructor(e){super(),this.code="ENOENT",this.name="PageNotFoundError",this.message=`Cannot find module for page: ${e}`}}class j extends Error{constructor(e,t){super(),this.message=`Failed to load static file for page: ${e} ${t}`}}class v extends Error{constructor(){super(),this.code="ENOENT",this.message="Cannot find the middleware module"}}function N(e){return JSON.stringify({message:e.message,stack:e.stack})}},32192,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"isLocalURL",{enumerable:!0,get:function(){return a}});let n=e.r(98334),s=e.r(32957);function a(e){if(!(0,n.isAbsoluteUrl)(e))return!0;try{let t=(0,n.getLocationOrigin)(),r=new URL(e,t);return r.origin===t&&(0,s.hasBasePath)(r.pathname)}catch(e){return!1}}},92364,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"errorOnce",{enumerable:!0,get:function(){return n}});let n=e=>{}},70065,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={default:function(){return g},useLinkStatus:function(){return b}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});let a=e.r(44066),o=e.r(87433),c=a._(e.r(44440)),i=e.r(48077),l=e.r(31270),u=e.r(36770),d=e.r(98334),p=e.r(39468);e.r(45694);let f=e.r(49629),h=e.r(32192),m=e.r(95130);function x(e){return"string"==typeof e?e:(0,i.formatUrl)(e)}function g(t){var r;let n,s,a,[i,g]=(0,c.useOptimistic)(f.IDLE_LINK_STATUS),b=(0,c.useRef)(null),{href:j,as:v,children:N,prefetch:w=null,passHref:k,replace:S,shallow:E,scroll:C,onClick:T,onMouseEnter:_,onTouchStart:M,legacyBehavior:P=!1,onNavigate:O,ref:A,unstable_dynamicOnHover:R,...L}=t;n=N,P&&("string"==typeof n||"number"==typeof n)&&(n=(0,o.jsx)("a",{children:n}));let $=c.default.useContext(l.AppRouterContext),I=!1!==w,U=!1!==w?null===(r=w)||"auto"===r?m.FetchStrategy.PPR:m.FetchStrategy.Full:m.FetchStrategy.PPR,{href:W,as:D}=c.default.useMemo(()=>{let e=x(j);return{href:e,as:v?x(v):e}},[j,v]);if(P){if(n?.$$typeof===Symbol.for("react.lazy"))throw Object.defineProperty(Error("`<Link legacyBehavior>` received a direct child that is either a Server Component, or JSX that was loaded with React.lazy(). This is not supported. Either remove legacyBehavior, or make the direct child a Client Component that renders the Link's `<a>` tag."),"__NEXT_ERROR_CODE",{value:"E863",enumerable:!1,configurable:!0});s=c.default.Children.only(n)}let B=P?s&&"object"==typeof s&&s.ref:A,F=c.default.useCallback(e=>(null!==$&&(b.current=(0,f.mountLinkInstance)(e,W,$,U,I,g)),()=>{b.current&&((0,f.unmountLinkForCurrentNavigation)(b.current),b.current=null),(0,f.unmountPrefetchableInstance)(e)}),[I,W,$,U,g]),z={ref:(0,u.useMergedRef)(F,B),onClick(t){P||"function"!=typeof T||T(t),P&&s.props&&"function"==typeof s.props.onClick&&s.props.onClick(t),!$||t.defaultPrevented||function(t,r,n,s,a,o,i){if("u">typeof window){let l,{nodeName:u}=t.currentTarget;if("A"===u.toUpperCase()&&((l=t.currentTarget.getAttribute("target"))&&"_self"!==l||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey||t.nativeEvent&&2===t.nativeEvent.which)||t.currentTarget.hasAttribute("download"))return;if(!(0,h.isLocalURL)(r)){a&&(t.preventDefault(),location.replace(r));return}if(t.preventDefault(),i){let e=!1;if(i({preventDefault:()=>{e=!0}}),e)return}let{dispatchNavigateAction:d}=e.r(70701);c.default.startTransition(()=>{d(n||r,a?"replace":"push",o??!0,s.current)})}}(t,W,D,b,S,C,O)},onMouseEnter(e){P||"function"!=typeof _||_(e),P&&s.props&&"function"==typeof s.props.onMouseEnter&&s.props.onMouseEnter(e),$&&I&&(0,f.onNavigationIntent)(e.currentTarget,!0===R)},onTouchStart:function(e){P||"function"!=typeof M||M(e),P&&s.props&&"function"==typeof s.props.onTouchStart&&s.props.onTouchStart(e),$&&I&&(0,f.onNavigationIntent)(e.currentTarget,!0===R)}};return(0,d.isAbsoluteUrl)(D)?z.href=D:P&&!k&&("a"!==s.type||"href"in s.props)||(z.href=(0,p.addBasePath)(D)),a=P?c.default.cloneElement(s,z):(0,o.jsx)("a",{...L,...z,children:n}),(0,o.jsx)(y.Provider,{value:i,children:a})}e.r(92364);let y=(0,c.createContext)(f.IDLE_LINK_STATUS),b=()=>(0,c.useContext)(y);("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},58432,e=>{"use strict";var t=e.i(87433),r=e.i(58447),n=e.i(44440),s=e.i(24876),a=e.i(633);function o(){let{status:e}=(0,s.useWebSocket)(),{agents:r}=(0,a.useAgents)(),[o,c]=(0,n.useState)("");(0,n.useEffect)(()=>{let e=()=>{c(new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))};e();let t=setInterval(e,3e4);return()=>clearInterval(t)},[]);let i=r.filter(e=>"running"===e.state||"ready"===e.state).length,l="connected"===e?"bg-ctp-green":"auth_failed"===e?"bg-ctp-red":"bg-ctp-yellow";return(0,t.jsxs)("div",{className:"flex items-center gap-4 text-xs font-mono text-ctp-subtext0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1.5",title:`Gateway: ${e}`,children:[(0,t.jsx)("span",{className:`w-2 h-2 rounded-full ${l}`}),(0,t.jsx)("span",{className:"hidden sm:inline",children:e})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5",title:`${i} agent(s) running`,children:[(0,t.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor",children:(0,t.jsx)("path",{d:"M5 3a3 3 0 1 1 6 0 3 3 0 0 1-6 0zm-1 8a4 4 0 0 1 8 0v1H4v-1z"})}),(0,t.jsx)("span",{children:i})]}),(0,t.jsx)("div",{className:"text-ctp-subtext1 font-medium tabular-nums",children:o})]})}function c(){return(0,t.jsxs)("header",{className:"h-8 bg-ctp-crust border-b border-ctp-surface0 flex items-center justify-between px-4 select-none shrink-0",children:[(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)("span",{className:"font-mono font-bold text-xs text-ctp-blue tracking-wider",children:"AgentRun"})}),(0,t.jsx)(o,{})]})}var i=e.i(70065),l=e.i(62924);let u=[{href:"/",label:"Monitor",icon:(0,t.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2"}),(0,t.jsx)("path",{d:"M8 21h8M12 17v4"}),(0,t.jsx)("path",{d:"M6 10h2M10 8h2M14 11h2M18 9h2"})]})},{href:"/chat",label:"Terminal",icon:(0,t.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("polyline",{points:"4 17 10 11 4 5"}),(0,t.jsx)("line",{x1:"12",y1:"19",x2:"20",y2:"19"})]})},{href:"/agents",label:"Tasks",icon:(0,t.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("rect",{x:"2",y:"3",width:"20",height:"18",rx:"2"}),(0,t.jsx)("path",{d:"M6 8h12M6 12h12M6 16h8"})]})},{href:"/memory",label:"Files",icon:(0,t.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:(0,t.jsx)("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"})})},{href:"/security",label:"Security",icon:(0,t.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:(0,t.jsx)("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})})},{href:"/settings",label:"Prefs",icon:(0,t.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("circle",{cx:"12",cy:"12",r:"3"}),(0,t.jsx)("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}];function d(){let e=(0,l.usePathname)();return(0,t.jsx)("nav",{className:"h-14 bg-ctp-crust/95 backdrop-blur-sm border-t border-ctp-surface0 flex items-center justify-center gap-1 px-4 select-none shrink-0",children:u.map(r=>{let n="/"===r.href?"/"===e:e.startsWith(r.href);return(0,t.jsxs)(i.default,{href:r.href,className:`flex flex-col items-center gap-0.5 px-4 py-1.5 rounded-panel transition-colors ${n?"text-ctp-blue bg-ctp-blue/10":"text-ctp-overlay1 hover:text-ctp-text hover:bg-ctp-surface0/50"}`,children:[r.icon,(0,t.jsx)("span",{className:"text-2xs font-mono font-medium",children:r.label})]},r.href)})})}var p=e.i(44814);function f({onComplete:e}){let{status:r,authenticate:o,setOperatorAgentId:c}=(0,s.useWebSocket)(),{agents:i}=(0,a.useAgents)(),[l,u]=(0,n.useState)("connection"),[d,f]=(0,n.useState)(null),[h,m]=(0,n.useState)(""),[x,g]=(0,n.useState)(""),[y,b]=(0,n.useState)(!1),j=(0,n.useCallback)(async()=>{b(!0);try{let e=await fetch((0,p.getHealthUrl)(),{signal:AbortSignal.timeout(5e3)});f(e.ok),e.ok&&u("auth")}catch{f(!1)}finally{b(!1)}},[]);(0,n.useEffect)(()=>{j()},[j]),(0,n.useEffect)(()=>{"auth"===l&&"connected"===r&&u("operator")},[l,r]);let v=()=>{h.trim()?o(h.trim()):u("operator")};(0,n.useEffect)(()=>{if("done"===l){let t=setTimeout(e,600);return()=>clearTimeout(t)}},[l,e]);let N=["connection","auth","operator","done"],w=N.indexOf(l);return(0,t.jsx)("div",{className:"h-screen flex items-center justify-center bg-ctp-crust",children:(0,t.jsxs)("div",{className:"w-full max-w-lg",children:[(0,t.jsxs)("div",{className:"text-center mb-8",children:[(0,t.jsxs)("div",{className:"inline-flex items-center gap-3 mb-2",children:[(0,t.jsxs)("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",className:"text-ctp-blue",children:[(0,t.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"3",stroke:"currentColor",strokeWidth:"1.5"}),(0,t.jsx)("circle",{cx:"8.5",cy:"9",r:"1.5",fill:"currentColor"}),(0,t.jsx)("circle",{cx:"15.5",cy:"9",r:"1.5",fill:"currentColor"}),(0,t.jsx)("path",{d:"M8 15c1.5 1.5 6.5 1.5 8 0",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]}),(0,t.jsx)("span",{className:"text-xl font-mono font-bold text-ctp-text",children:"AgentRun"})]}),(0,t.jsx)("p",{className:"text-sm text-ctp-overlay0 font-mono",children:"Setup Assistant"})]}),(0,t.jsx)("div",{className:"flex items-center gap-1 mb-8 px-4",children:N.map((e,r)=>(0,t.jsx)("div",{className:"flex-1 flex items-center",children:(0,t.jsx)("div",{className:`h-1 w-full rounded-full transition-colors duration-300 ${r<=w?"bg-ctp-blue":"bg-ctp-surface0"}`})},e))}),(0,t.jsxs)("div",{className:"bg-ctp-mantle border border-ctp-surface0 rounded-window mx-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 px-4 py-3 border-b border-ctp-surface0",children:[(0,t.jsxs)("div",{className:"flex gap-1.5",children:[(0,t.jsx)("span",{className:"w-2.5 h-2.5 rounded-full bg-ctp-red/60"}),(0,t.jsx)("span",{className:"w-2.5 h-2.5 rounded-full bg-ctp-yellow/60"}),(0,t.jsx)("span",{className:"w-2.5 h-2.5 rounded-full bg-ctp-green/60"})]}),(0,t.jsx)("span",{className:"text-xs font-mono text-ctp-overlay0 ml-2",children:"setup-assistant"})]}),(0,t.jsxs)("div",{className:"p-6",children:["connection"===l&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-base font-mono font-semibold text-ctp-text mb-1",children:"Checking Connection"}),(0,t.jsx)("p",{className:"text-sm text-ctp-subtext0 mb-6",children:"Looking for the AgentRun gateway on this machine."}),(0,t.jsx)("div",{className:"os-panel px-4 py-3 mb-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[y?(0,t.jsx)("div",{className:"w-3 h-3 rounded-full bg-ctp-yellow animate-pulse"}):d?(0,t.jsx)("div",{className:"w-3 h-3 rounded-full bg-ctp-green"}):(0,t.jsx)("div",{className:"w-3 h-3 rounded-full bg-ctp-red"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm font-mono text-ctp-text",children:y?"Checking...":d?"Gateway detected":"Gateway not found"}),(0,t.jsx)("div",{className:"text-2xs text-ctp-overlay0 font-mono",children:(0,p.getHealthUrl)()})]})]})}),!1===d&&(0,t.jsxs)("div",{className:"text-xs text-ctp-subtext0 mb-4 font-mono",children:["Make sure the gateway is running:",(0,t.jsx)("br",{}),(0,t.jsx)("code",{className:"text-ctp-peach",children:"pnpm --filter gateway dev"})]}),(0,t.jsxs)("div",{className:"flex gap-2 justify-end",children:[!1===d&&(0,t.jsx)("button",{onClick:j,disabled:y,className:"px-4 py-2 text-sm font-mono bg-ctp-surface0 text-ctp-text rounded-input hover:bg-ctp-surface1 transition-colors disabled:opacity-50",children:"Retry"}),d&&(0,t.jsx)("button",{onClick:()=>u("auth"),className:"px-4 py-2 text-sm font-mono bg-ctp-blue text-ctp-crust rounded-input hover:opacity-90 transition-opacity",children:"Continue"})]})]}),"auth"===l&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-base font-mono font-semibold text-ctp-text mb-1",children:"Authentication"}),(0,t.jsx)("p",{className:"text-sm text-ctp-subtext0 mb-6",children:"Enter your gateway auth token, or skip if auth is disabled."}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-xs font-mono text-ctp-subtext0 mb-1.5",children:"Auth Token"}),(0,t.jsx)("input",{type:"password",value:h,onChange:e=>m(e.target.value),placeholder:"paste token here...",className:"w-full bg-ctp-surface0 border border-ctp-surface1 rounded-input px-3 py-2 text-sm font-mono text-ctp-text placeholder:text-ctp-overlay0 focus:outline-none focus:border-ctp-blue transition-colors",onKeyDown:e=>"Enter"===e.key&&v()})]}),"auth_failed"===r&&(0,t.jsx)("div",{className:"text-xs font-mono text-ctp-red mb-4",children:"Authentication failed. Check your token."}),(0,t.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,t.jsx)("button",{onClick:()=>u("operator"),className:"px-4 py-2 text-sm font-mono text-ctp-subtext0 hover:text-ctp-text transition-colors",children:"Skip"}),(0,t.jsx)("button",{onClick:v,className:"px-4 py-2 text-sm font-mono bg-ctp-blue text-ctp-crust rounded-input hover:opacity-90 transition-opacity",children:h.trim()?"Authenticate":"Continue"})]})]}),"operator"===l&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-base font-mono font-semibold text-ctp-text mb-1",children:"Operator Agent"}),(0,t.jsx)("p",{className:"text-sm text-ctp-subtext0 mb-6",children:"Select a running agent to act as the system operator, or skip to choose later."}),i.length>0?(0,t.jsx)("div",{className:"space-y-1.5 mb-4 max-h-48 overflow-y-auto",children:i.map(e=>(0,t.jsxs)("button",{onClick:()=>g(e.id),className:`w-full text-left os-panel px-3 py-2.5 transition-colors ${x===e.id?"border-ctp-blue bg-ctp-blue/10":"hover:border-ctp-surface1"}`,children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm font-mono text-ctp-text",children:e.id}),(0,t.jsx)("span",{className:`text-2xs font-mono ${"running"===e.state?"text-ctp-green":"text-ctp-overlay0"}`,children:e.state})]}),e.model&&(0,t.jsx)("div",{className:"text-2xs text-ctp-overlay0 font-mono mt-0.5",children:e.model})]},e.id))}):(0,t.jsxs)("div",{className:"os-panel px-4 py-6 text-center mb-4",children:[(0,t.jsx)("div",{className:"text-sm text-ctp-overlay0 font-mono mb-2",children:"No agents running"}),(0,t.jsx)("div",{className:"text-xs text-ctp-overlay0 font-mono",children:"Start agents from the Task Manager after setup."})]}),(0,t.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,t.jsx)("button",{onClick:()=>{u("done")},className:"px-4 py-2 text-sm font-mono text-ctp-subtext0 hover:text-ctp-text transition-colors",children:"Skip"}),(0,t.jsx)("button",{onClick:()=>{x&&c(x),u("done")},disabled:!x&&i.length>0,className:"px-4 py-2 text-sm font-mono bg-ctp-blue text-ctp-crust rounded-input hover:opacity-90 transition-opacity disabled:opacity-50",children:x?"Set Operator":"Continue"})]})]}),"done"===l&&(0,t.jsxs)("div",{className:"text-center py-4",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-ctp-green/20 flex items-center justify-center mx-auto mb-3",children:(0,t.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",className:"text-ctp-green",children:(0,t.jsx)("path",{d:"M5 13l4 4L19 7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,t.jsx)("h2",{className:"text-base font-mono font-semibold text-ctp-text mb-1",children:"Ready"}),(0,t.jsx)("p",{className:"text-sm text-ctp-subtext0",children:"Loading desktop..."})]})]})]}),(0,t.jsx)("div",{className:"flex justify-between px-4 mt-3",children:["Connection","Auth","Operator","Done"].map((e,r)=>(0,t.jsx)("span",{className:`text-2xs font-mono ${r<=w?"text-ctp-blue":"text-ctp-overlay0"}`,children:e},e))})]})})}function h({children:e}){let{operatorAgentId:r}=(0,s.useWebSocket)(),[a,o]=(0,n.useState)(!1),[i,l]=(0,n.useState)(!1);return((0,n.useEffect)(()=>{l(!0),"true"===localStorage.getItem("setupDismissed")&&o(!0)},[]),i)?r||a?(0,t.jsxs)("div",{className:"h-screen flex flex-col overflow-hidden",children:[(0,t.jsx)(c,{}),(0,t.jsx)("main",{className:"flex-1 overflow-auto p-4 lg:p-6",children:e}),(0,t.jsx)(d,{})]}):(0,t.jsx)(f,{onComplete:()=>{o(!0),localStorage.setItem("setupDismissed","true")}}):(0,t.jsx)("div",{className:"h-screen bg-ctp-base flex items-center justify-center",children:(0,t.jsx)("div",{className:"text-sm font-mono text-ctp-overlay0",children:"Loading..."})})}var m=n;class x extends m.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("[AgentRun] Uncaught render error:",e,t.componentStack)}render(){return this.state.hasError?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-ctp-base p-8",children:(0,t.jsxs)("div",{className:"max-w-lg w-full bg-ctp-mantle border border-ctp-red/30 rounded-window p-8",children:[(0,t.jsx)("h2",{className:"text-lg font-mono font-bold text-ctp-red mb-2",children:"Kernel Panic"}),(0,t.jsx)("p",{className:"text-sm text-ctp-subtext0 mb-4",children:"The dashboard encountered a fatal error. Try restarting."}),(0,t.jsx)("pre",{className:"text-xs text-ctp-red/70 bg-ctp-crust rounded-panel p-3 overflow-auto max-h-40 mb-4 font-mono",children:this.state.error?.message}),(0,t.jsx)("button",{onClick:()=>{this.setState({hasError:!1,error:null}),window.location.reload()},className:"px-4 py-2 text-sm font-mono font-medium bg-ctp-blue/20 text-ctp-blue rounded-input hover:bg-ctp-blue/30 transition-colors",children:"Reboot"})]})}):this.props.children}}function g({children:e}){return(0,t.jsxs)("html",{lang:"en",children:[(0,t.jsxs)("head",{children:[(0,t.jsx)("title",{children:"AgentRun"}),(0,t.jsx)("meta",{name:"description",content:"AgentRun â€” Run any AI agent safely"}),(0,t.jsx)("link",{rel:"icon",href:"/favicon.svg",type:"image/svg+xml"})]}),(0,t.jsx)("body",{children:(0,t.jsx)(x,{children:(0,t.jsx)(r.WebSocketProvider,{children:(0,t.jsx)(h,{children:e})})})})]})}e.s(["default",()=>g],58432)}]);